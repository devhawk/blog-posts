<p>Someone from the P2P team internally saw my blog and set me a list of
commands to execute and send back to him to help troubleshoot my
problem. One of those commands was “net start pnrpsvc”. Aha! I hadn’t
realized that the <a href="http://msdn.microsoft.com/downloads/list/winxppeer.asp">WinXP Adv. Networking
Pack</a> installed
any services. Turns out it installs four, including the “Peer Name
Resolution Protocol” service (i.e. pnrpsvc). What’s odd is that now that
I’ve started it manually once, it seems to autostart on demand now. I
can resolve addresses, as well as <a href="http://devhawk.net/2003/08/11/more-on-p2p-problems/">ping the seed
server</a>.
GraphChat doesn’t work yet, but I think that’s because the IPv6 firewall
only has two ports open by default – PNRP (UDP 3540) and Grouping (TCP
3587). The GraphChat sample uses a dynamically chosen port, which would
be blocked.</p>
<p>So now that I’m back on track, I’ve got the PNRP namespace provider API
wrapped in Managed C++. I can
<a href="http://msdn.microsoft.com/library/en-us/p2psdk/p2p/registering_a_peer_name.asp">register</a>,
<a href="http://msdn.microsoft.com/library/en-us/p2psdk/p2p/unregistering_a_peer_name.asp">unregister</a>,
<a href="http://msdn.microsoft.com/library/en-us/p2psdk/p2p/resolving_a_peer_name.asp">resolve</a>
and <a href="http://msdn.microsoft.com/library/en-us/p2psdk/p2p/enumerating_clouds.asp">enumerate PNRP
clouds</a>
from managed code. I’ve also got a first pass of the <a href="http://msdn.microsoft.com/library/en-us/p2psdk/p2p/identity_manager_api.asp">Identity Manager
API</a>
and a skeleton of the <a href="http://msdn.microsoft.com/library/en-us/p2psdk/p2p/graphing_api.asp">Graphing
API</a>
done. I’ll post code when I have a managed GraphChat sample working.</p>
