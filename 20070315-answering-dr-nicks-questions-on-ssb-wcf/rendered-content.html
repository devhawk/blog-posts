<p>Nick Allen <a href="http://blogs.msdn.com/drnick/archive/2007/03/15/looking-for-sql-service-broker-users.aspx">asked on his
blog</a>
about how people would like to see SSB and WCF work together. He‚Äôs
already heard these from me, but I figured I‚Äôd put them out there for
everyone to see and debate. Plus, I had several beers last night at the
MVP dinner, so this is likely to be more coherent than I was yesterday!
üòÑ</p>
<p>1. Are you interested in SSB because you‚Äôd like to have your service
closer to the database? How close is close enough to the database?</p>
<blockquote>
<p>I‚Äôve first blogged about the <a href="http://devhawk.net/2004/04/21/the-endangered-middle-tier-part-2/">endangered middle
tier</a>
almost three years ago. My point at the time was that as you break
your monolithic system up into services, the vast majority of those
services won‚Äôt need to scale out. You performance gets better the
closer you are to the data.¬†If you don‚Äôt need to scale out, why not
get the maximum boost by running in the database process itself?</p>
<p>Furthermore, in large IT shops, the database files are stored out on
the SAN rather than on hard drives attached to the database server
itself. That means the database server is effectively stateless. Why
add a second stateless tier if you don‚Äôt need scale out? If you need
more performance in a given service, you can detach the database file
from it‚Äôs current SQL server box and attach it on another more beefy
SQL server box without physically moving the database files at all.
This enables what I call the ‚ÄúStar Trek Effect‚Äù, where you can shift
computing power where it is needed most (more power to the payroll
system!).</p>
<p>Of course, if you‚Äôre going to move the service, you do need to bring
it down for a short time. That implies a need for durable messaging so
that service consumers aren‚Äôt affected by the brief service
interruption. Which brings us to‚Ä¶</p>
</blockquote>
<p>2. Are you interested in SSB because you need durable, duplex messaging
between two services? Do you need exactly-once-in-order message
delivery?</p>
<blockquote>
<p>Yes. SSB has a bunch of other nice features, but durable duplex
messaging is what I need the most. Exactly-once-in-order is also
fairly critical, though there may be scenarios where it‚Äôs not really
necessary. Those are the exception, not the rule however.</p>
<p>Doesn‚Äôt WS-RM already do EOIO already?</p>
</blockquote>
<p>3. Are you interested in using SSB from WCF because you want a better
asynchronous messaging experience than MSMQ? What makes you prefer SSB
to other queuing products?</p>
<blockquote>
<p>My primary problem with MSMQ for the problems I‚Äôm tasked with solving
is that MSMQ is one way while SSB supports duplex messaging. You could
do duplex messaging with MSMQ if you didn‚Äôt mind managing multiple
queues (one for each side of the conversation) but SSB does this for
you for free. I‚Äôm sure there are scenarios where pure one-way
messaging are useful, but they are few and far between in my day job.</p>
<p>Furthermore, SSB has the explicit idea of a service instance (they
call it a conversation group) which MSMQ lacks. SSB‚Äôs implementation
is conceptually similar to the new WCF/WF integration work in the
latest Orcas CTP.</p>
<p>Finally, SSB uses logical naming. You have conversations between
services, but services get mapped to physical addresses at the routing
layer. This allows services to move around more easily (see the ‚ÄúStar
Trek Effect‚Äù in #1 above). Both MSMQ and WCF use physical addresses,
which makes them much more difficult to move.</p>
</blockquote>
<p>4. Are you interested in having your data contracts defined in WCF, SQL,
or both?</p>
<blockquote>
<p>I like WCF‚Äôs data contract infrastructure. We did a early prototype
long-running service with both WCF and SSB. the messaging stack code
was obviously different, but we used the exact same data contract
code. I even wrote some code to automatically deserialize the SSB
message by mapping the SSB message type to a data contract.</p>
<p>I want my services to run inside the database, but that doesn‚Äôt mean I
want to write them in T-SQL. Personally, I‚Äôm much more productive in
C# and/or WF. So WCF data contracts are fine by me.</p>
</blockquote>
