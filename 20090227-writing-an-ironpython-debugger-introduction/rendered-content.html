<p>A while back I <a href="http://devhawk.net/2008/05/08/debugging-ironpython-code-in-visual-studio/">showed
how</a>
you can use Visual Studio to debug IronPython scripts. While that works
great, it’s lots of steps and lots of mouse work. I yearned for
something lighter weight and that I could drive from the command line.</p>
<p>The .NET framework includes a command line debugger called
<a href="http://msdn.microsoft.com/en-us/library/ms229861.aspx">MDbg</a>, but after
using it for a bit, I found it didn’t like it very much for IronPython
debugging. Mdbg automatically sets a breakpoint on the main entrypoint
function, but only if it can find the debugging symbols. So when you use
Mdbg with the released version of IPy, the breakpoint never gets set.
Instead, you have to trap the module load event, set a breakpoint in the
python file you’re debugging, then stop trapping the module load event.
Every Time. That gets tedious.</p>
<p>Another problem with MDbg is that it’s not
<a href="http://blogs.msdn.com/jmstall/archive/2004/12/31/344832.aspx">Just-My-Code</a>
(aka JMC) aware. JMC is this awesome debugging feature that was
introduced in .NET 2.0 that lets the debugger “paint” the parts of the
code that you want to step thru (aka “My Code”). By default, Visual
Studio marks code with symbols as “my code” and code without symbols as
“not my code”. <a id="fnref:1" href="#fn:1" class="footnote-ref"><sup>1</sup></a> We don’t ship symbols with IronPython releases, so
Visual Studio does only steps thru the python code. MDbg doesn’t support
JMC, so I often found myself stepping into random parts of the
IronPython implementation. That’s even more tedious.</p>
<p>Luckily, the <a href="http://www.microsoft.com/downloads/details.aspx?familyid=38449a42-6b7a-4e28-80ce-c55645ab1310&amp;displaylang=en">source
code</a>
to MDbg is available. So I got the wacky idea to build a debugger
specifically for IronPython. CPython includes
<a href="http://docs.python.org/library/pdb.html">pdb</a> (aka Python Debugger, not
<a href="http://msdn.microsoft.com/en-us/library/yd4f8bd1.aspx">Program
Database</a>) but we
don’t support it because we <a href="http://ironpython.codeplex.com/WorkItem/View.aspx?WorkItemId=1042">haven’t
implemented</a><a href="http://docs.python.org/library/sys.html#sys.settrace">settrace</a>.
Thus, ipydbg was born.</p>
<p>Over the course of this series of blog posts, I’m going to build out
ipydbg. I have built out a series of prototypes so I fairly confident
that I know <em>how</em> to build it. However, I’m not sure what it will look
like at the end. If you’ve got any strong opinions on it one way or the
other, be sure to email me or leave me comments.</p>
<p>BTW, major thanks to my VSL teammate <a href="http://blogs.msdn.com/jmstall">Mike
Stall</a> (of Mike Stall’s .NET Debugging
Blog). Without his help, I would probably still be trying to make heads
or tails of the MDbg source.</p>
<div class="footnotes">
<hr />
<ol>
<li id="fn:1">
<p>VS uses the
<a href="http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggernonusercodeattribute.aspx">DebuggerNonUserCode</a>
attribute to provide fine grained control of what is considered “my
code” and should be stepped thru.<a href="#fnref:1" class="footnote-back-ref">&#8617;</a></p>
</li>
</ol>
</div>
