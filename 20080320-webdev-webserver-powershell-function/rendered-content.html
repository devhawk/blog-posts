<p>In experimenting with <a href="http://www.codeplex.com/NWSGI">NWSGI</a> yesterday,
I found I wanted the ability to launch the development web server that
ships with Visual Studio (WebDev.WebServer.exe) from the command line. I
hacked up the following PowerShell function and dropped it into my
$profile so I can easily launch the web server in any directory any
time I need. Thought I’d share:</p>
<div class="lang-powershell editor-colors"><div style="color:Black;background-color:White;"><pre>
<span style="color:Blue;">function</span> webdev(<span style="color:OrangeRed;">$path</span>,<span style="color:OrangeRed;">$port</span><span style="color:Gray;">=</span>8080,<span style="color:OrangeRed;">$vpath</span><span style="color:Gray;">=</span><span style="color:#A31515;">&#39;/&#39;</span>)
{
    <span style="color:OrangeRed;">$spath</span> <span style="color:Gray;">=</span> <span style="color:#A31515;">&#39;C:\Program Files\Common Files\microsoft shared\DevServer9.0\WebDev.WebServer.EXE&#39;</span>
    <span style="color:OrangeRed;">$rpath</span> <span style="color:Gray;">=</span> resolve<span style="color:Gray;">-</span>path <span style="color:OrangeRed;">$path</span>  
    <span style="color:OrangeRed;">$params</span> <span style="color:Gray;">=</span> <span style="color:#A31515;">&quot;/path:`&quot;$rpath`&quot; /port:$port /vpath:$vpath&quot;</span>  

    <span style="color:OrangeRed;">$ignore</span> <span style="color:Gray;">=</span> <span style="color:Gray;">[</span><span style="color:Teal;">System.Diagnostics.Process</span><span style="color:Gray;">]</span><span style="color:Gray;">::</span>Start(<span style="color:OrangeRed;">$spath</span>, <span style="color:OrangeRed;">$params</span>)  
    <span style="color:#A31515;">&quot;Started WebDev Server for &#39;$path&#39; directory on port $port&quot;</span>  
}

</pre></div>
</div>
<p>There’s probably an easier way to launch an exe with parameters than
Sys.Diags.Process.Start, but it works. Using resolve-path is the key,
that lets me pass in a relative path on the command line, but the script
converts it to an absolute path in order to pass it to the webdev
server. Also, I’m not sure I should have hard coded the path to the exe,
but again it works and it’s not like it’s tough to change.</p>
<p>Enjoy.</p>
<p><strong>Update</strong>: Tomas
Restrepo pointed out an easier way to start the process:</p>
<div class="lang-powershell editor-colors"><div style="color:Black;background-color:White;"><pre>
&amp;<span style="color:#A31515;">&#39;C:\Program Files\Common Files\microsoft shared\DevServer9.0\WebDev.WebServer.EXE&#39;</span> <span style="color:#A31515;">&quot;/path:$rpath&quot;</span> <span style="color:#A31515;">&quot;/port:$port&quot;</span> <span style="color:#A31515;">&quot;/vpath:$vpath&quot;</span>

</pre></div>
</div>
<p>I couldn’t figure out how to correctly launch the exe when the physical
path to serve has a space in it. Thanks Tomas.</p>
