<p>I&#8217;m thinking about redoing the backend of this website. I started to do pingback/trackback support and got discouraged by the fact that I would again have to pick an arbitrary length for the database columns. Of all the annoyances with databases, that&#8217;s my biggest pet peeve. Maybe <a href="http://www.microsoft.com/sql/evaluation/yukon.asp">SQL &#8220;Yukon&#8221;</a> with it&#8217;s ability to <a href="http://www.microsoft.com/technet/treeview/default.asp?url=/technet/itcommunity/chats/trans/sql/sql0517.asp"> natively store XML</a> will solve this problem.</p>
<p>However, until then, I need to use something to store my entries in. <a href="http://www.simplegeek.com/">BlogX</a> uses XML files, which seems like trading one evil for another. Picking a max length for a column is annoying, but I don&#8217;t relish rolling my own database. <a href="http://bbooprevalence.sourceforge.net">Bamboo.Prevalence</a> is interesting, but I don&#8217;t like the fact that everything is kept in memory all the time. I&#8217;ve read the <a href="http://www.prevayler.org/wiki.jsp?topic=PrevalenceSkepticalFAQ"> Prevalence Skeptical FAQ</a> with their entries on <a href="http://www.prevayler.org/wiki.jsp?topic=BreakthroughsInMemoryTechnology"> Breakthroughs in Memory Technology</a> (which haven&#8217;t happened yet) and their <a href="http://www.prevayler.org/wiki.jsp?topic=IsItTrueThatPrevaylerIsThreeThousandTimesFasterThanMYSQL"> Scalability Test Results</a> (testing a paltry 1 million rows in a single table &#8211; though obviously DevHawk has much less data than that) and I&#8217;m still skeptical. </p>
<p>I am impressed with the implementation of Prevalance &#8211; especially the <a href="http://bbooprevalence.sourceforge.net/MyFirstPrevalentSystem.htm"> transparent engine</a> feature of Bamboo. From what I can tell from the outside, it serializes the methods calls against the Prevalyent (?) object so on app restart, the engine can return to when it left off. It also can serialize the Prevalyent object itself for snapshot purposes. Simple, but elegant &#8211; except for the memory usage. I tested a simple Bamboo.Prevalence app with a snapshot of DevHawk&#8217;s database. The entry list wasn&#8217;t too bad but the referrals list was huge &#8211; an order of magnitude bigger in memory than the entry list! Given that I do nothing with the referrals list but archive it keeping it in memory seems like a waste. What I want is something like Prevalence but with more flexibility with regard to memory usage. I only want to keep the past month&#8217;s worth of entries and the past day&#8217;s worth of referrals in memory all the time.</p>
<p>I&#8217;m thinking that you could build something similar to Prevalance that used <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemweakreferenceclasstopic.asp"> Weak References</a> to enable the GC to clean up memory of infrequently used objects but then use <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfSystemRuntimeRemotingProxiesRealProxyClassTopic.asp"> Proxies</a> to reload them transparently from disk on command. <a href="http://msdn.microsoft.com/msdnmag/issues/1100/GCI/default.aspx"> Resurrection</a> could be used to avoid collecting objects that are likely to be used in the near future (i.e. recent entries).</p>
