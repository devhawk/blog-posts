<?xml version="1.0" encoding="utf-8"?>
<item>
  <title>Thoughts on CAB</title>
  <link>http://devhawk.net/2005/11/23/thoughts-on-cab/</link>
  <pubDate>Wed, 23 Nov 2005 00:01:02 +0000</pubDate>
  <dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">devhawk</dc:creator>
  <guid isPermaLink="false">http://6e17873f-9d5b-401e-a9b4-609394e97e3f</guid>
  <description></description>
  <content:encoded xmlns:content="http://purl.org/rss/1.0/modules/content/"><![CDATA[<p></p><p>As I wrote earlier, I'm really impressed with <a href="http://msdn.microsoft.com/practices">p&amp;p</a>'s latest release - the <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnpag2/html/cabctp.asp">Composite UI Application Block</a>. I had to fly to Atlanta for a customer meeting last week and I spent most of my spare time (flying, in hotel, etc) digging thru CAB. Well, digging through CAB and reading <a href="http://www.crichton-official.com/fear/index.html">State of Fear</a> by <a href="http://www.crichton-official.com/">Michael Crichton</a>. IMO, it's his best book in quite a while, perhaps second best he's ever written after Jurassic Park.</p><p>Back to CAB. First off, I want more information about ObjectBuilder. p&amp;p's dependency injection framework is very impressive. However, with the exception of the code, the code reference in the help files, the unit tests, and a single article on how it was designed there just isn't much info on it. For example, I <i>know</i> I can use it to inject a concrete type where a class is expecting an abstract type. But I couldn't figure out how so I went and asked <a href="http://www.peterprovost.org/">Peter</a> and <a href="http://www.agileprogrammer.com/dotnetguy/">Brad</a>. (Short answer - use TypeMappingPolicy). Do me a favor, go contact <a href="http://www.peterprovost.org/contact.aspx">Peter</a> and <a href="http://www.agileprogrammer.com/dotnetguy/contact.aspx">David</a> and tell them you want more info on ObjectBuilder. Sample code especially. Go on, drop them a line right now while you're thinking about it. I'll wait.</p><p>Back already? Cool. One thing you can't help but notice about CAB (and OB for that matter) is the heavy use of attributes, which I feel is an extremely elegant solution. Remember the first time you looked at <a href="http://www.nunit.org/">NUnit</a>? How <i>sensible </i>it seemed to use attributes like [TestFixture], [Test] and [ExpectedException] compared to what other xUnit frameworks provide? Get ready to experience that all over again when you look at OB and CAB. Now you're looking at attributes like [CreateNew], [EventPublication] and [CommandHandler]. There's a reason why Sun <a href="http://java.sun.com/j2se/1.5.0/docs/guide/language/annotations.html">cloned attributes</a> for J2SE 5.0 - it's powerful (in the right hands). The attributes both drive human readability - when you're looking at a property adorned with [CreateNew] or [Dependency] it's obvious that these are injected - as well as the implementation. Win-win as far as I'm concerned.</p><p>CAB does a great job of codifying standard patterns in smart client design, such as events, commands and controllers, as well as implementing completely new ideas such as workspaces, work items and smart parts. And they've done it with an eye on the future. I love the isolation between the windows forms specific parts of CAB and the underlying infrastructure of CAB. Check out <a href="http://msdn.microsoft.com/library/en-us/dnpag2/html/cabcbt_02.png">this picture</a> of the layers of CAB. By isolating all the WinForms specific stuff in a separate assembly, they are well set up to support <a href="http://msdn.microsoft.com/windowsvista/building/presentation/">WPF</a> while minimizing redundant effort. I can't wait to see a Microsoft.Practices.CompositeUI.Avalon project (because Microsoft.Practices.CompositeUI.WindowsPresentationFoundation is just to long a namespace).</p><p>However, I can't shake the feeling of how complex this stuff is. Yeah, you use CAB for solving complex problems, but there is a significant learning curve here. I imagine debugging a CAB app will be significantly non-trivial. Take a look at the final step of the walkthru app. Here's the sequence that gets "hello world" painted on the screen:</p><ol><li>Main entrypoint creates and runs the ShellApplication.</li><li>ShellApplication creates a ShellForm window, which in turn contains the tabWorkspace1 workspace.</li><li>ShellApplication dynamically loads MyModule because it's listed in the ProfileCatalog.xml file.</li><li>CAB creates an instance of the MyModuleInit class from the MyModule assembly.</li><li>MyModuleInit creates and runs an instance of MyWorkItem.</li><li>MyWorkItem creates a MyView and MyPresenter.</li><li>MyWorkItem adds the MyView instance to the tabWorkspace1 workspace, hosted in the ShellForm</li><li>MyPresenter handles the MyView load event and sets the message property of MyView to "Hello, World"</li></ol><p>Of course, the point of a demo app like the walkthru is comprehension. You would never use CAB to build this Hello World app. But I worry that the level of complexity will put CAB beyond the reach or inclination on many potential users. I imagine this single line of code will scare off many would-be CAB developers:</p><p style="FONT-FAMILY: courier new"><span style="COLOR: #008080">MyWorkItem</span> myWorkItem = parentWorkItem.WorkItems.AddNew&lt;<span style="COLOR: #008080">MyWorkItem</span>&gt;();</p><p>Given that most people are used to writing "<span style="FONT-FAMILY: courier new"><span style="COLOR: blue">new</span><span style="COLOR: #008080">MyWorkItem</span>()</span>", the line above represents a significantly rise in complexity. Of course, CAB is trying to solve a complex problem. I'm sure CAB's designers would rather the solution wasn't so complex, but that's the reality of the problem space their dealing with. </p><p>If you can't lower the complexity of your framework, it's time to raise the abstraction of your tools. </p><p>I wonder what CAB specific tooling would look like? At a minimum, it would like built in support for the primary concepts in CAB - WorkItem, SmartPart, Workspace and Service to name a few. Another opportunity would be to move from embedded strings, used to identify events, commands, UIExtensionSites and the like to true variable-style names that could be validated at compile time, sort of like how LINQ is extending C# to get rid of embedded database query commands. There's lots of possibilities and the more I work w/ CAB the better idea I'll have about them.</p>]]></content:encoded>
  <excerpt:encoded xmlns:excerpt="http://wordpress.org/export/1.2/excerpt/"><![CDATA[]]></excerpt:encoded>
  <wp:post_id xmlns:wp="http://wordpress.org/export/1.2/">658</wp:post_id>
  <wp:post_date xmlns:wp="http://wordpress.org/export/1.2/">2005-11-23 00:01:02</wp:post_date>
  <wp:post_date_gmt xmlns:wp="http://wordpress.org/export/1.2/">2005-11-23 00:01:02</wp:post_date_gmt>
  <wp:comment_status xmlns:wp="http://wordpress.org/export/1.2/">open</wp:comment_status>
  <wp:ping_status xmlns:wp="http://wordpress.org/export/1.2/">open</wp:ping_status>
  <wp:post_name xmlns:wp="http://wordpress.org/export/1.2/">thoughts-on-cab</wp:post_name>
  <wp:status xmlns:wp="http://wordpress.org/export/1.2/">publish</wp:status>
  <wp:post_parent xmlns:wp="http://wordpress.org/export/1.2/">0</wp:post_parent>
  <wp:menu_order xmlns:wp="http://wordpress.org/export/1.2/">0</wp:menu_order>
  <wp:post_type xmlns:wp="http://wordpress.org/export/1.2/">post</wp:post_type>
  <wp:post_password xmlns:wp="http://wordpress.org/export/1.2/"></wp:post_password>
  <wp:is_sticky xmlns:wp="http://wordpress.org/export/1.2/">0</wp:is_sticky>
  <category domain="category" nicename="architecture"><![CDATA[Architecture]]></category>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_entryid</wp:meta_key>
    <wp:meta_value><![CDATA[6e17873f-9d5b-401e-a9b4-609394e97e3f]]></wp:meta_value>
  </wp:postmeta>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_compressedtitle</wp:meta_key>
    <wp:meta_value><![CDATA[Thoughts+On+CAB]]></wp:meta_value>
  </wp:postmeta>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_compressedtitleunique</wp:meta_key>
    <wp:meta_value><![CDATA[2005/11/23/Thoughts+On+CAB]]></wp:meta_value>
  </wp:postmeta>
  <wp:comment xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:comment_id>2871</wp:comment_id>
    <wp:comment_author><![CDATA[Chris Bilson]]></wp:comment_author>
    <wp:comment_author_email>cbilson@pobox.com</wp:comment_author_email>
    <wp:comment_author_url>http://www.factored-software.com/iimplement</wp:comment_author_url>
    <wp:comment_author_IP>24.19.175.168</wp:comment_author_IP>
    <wp:comment_date>2005-11-23 04:39:12</wp:comment_date>
    <wp:comment_date_gmt>2005-11-23 12:39:12</wp:comment_date_gmt>
    <wp:comment_content><![CDATA[I too have been very impressed by CAB. I learned about it very late, at Code Camp Seattle. I spent about a week or two totally into it, trying to understand everything about it.

I was also a little scared by the complexity. I had the good fortune of working on a project very simmilar to what CAB does, only in .NET 1.1, earlier this year. I would say that application was 120% the complexity of CAB, maybe because the developers weren't charged with building something as polished for general use as CAB. It also lacked some of the really neato features of the CAB, like OB, because they weren't neccesary for what they were doing.

If the CAB saves some teams the effort that went into building the framework I got to work with earlier this year (maybe 10 developers * 4 months), then I would have to conclude that the CAB is a huge benefit for the community.

Finally, I hesitate to agree that raising the abstraction level of tools is a good idea. That's just hiding the complexity that's already there inside of more complexity. If you ever need to look under the hood, it's even harder to grok. I think it would be better to go the other way. Try removing stuff to combat complexity.]]></wp:comment_content>
    <wp:comment_approved>1</wp:comment_approved>
    <wp:comment_type></wp:comment_type>
    <wp:comment_parent>0</wp:comment_parent>
    <wp:comment_user_id>0</wp:comment_user_id>
  </wp:comment>
  <wp:comment xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:comment_id>2872</wp:comment_id>
    <wp:comment_author><![CDATA[Mark Seemann]]></wp:comment_author>
    <wp:comment_author_email></wp:comment_author_email>
    <wp:comment_author_url>http://blogs.msdn.com/ploeh</wp:comment_author_url>
    <wp:comment_author_IP>217.157.224.143</wp:comment_author_IP>
    <wp:comment_date>2006-05-05 05:43:50</wp:comment_date>
    <wp:comment_date_gmt>2006-05-05 12:43:50</wp:comment_date_gmt>
    <wp:comment_content><![CDATA[To see how you can inject a concrete type when an abstract type is requested, see my recent post on the subject at http://blogs.msdn.com/ploeh/archive/2006/05/04/CuttingCABTheOtherWay.aspx]]></wp:comment_content>
    <wp:comment_approved>1</wp:comment_approved>
    <wp:comment_type></wp:comment_type>
    <wp:comment_parent>0</wp:comment_parent>
    <wp:comment_user_id>0</wp:comment_user_id>
  </wp:comment>
</item>