{"status":"ok","post":{"id":827,"type":"post","slug":"slight-workflow-annoyance","url":"http:\/\/devhawk.net\/2006\/11\/03\/slight-workflow-annoyance\/","status":"publish","title":"Slight Workflow Annoyance","title_plain":"Slight Workflow Annoyance","content":"<p>One of the cool things about WF is that you can specify the Guid it uses to identify a workflow instance. <a href=\"http:\/\/windowssdk.msdn.microsoft.com\/en-us\/library\/system.workflow.runtime.workflowruntime.createworkflow.aspx\">WorkflowRuntime.CreateWorkflow<\/a>\u00a0has an <a href=\"http:\/\/windowssdk.msdn.microsoft.com\/en-us\/library\/ms594870.aspx\">overload<\/a> (actually <a href=\"http:\/\/windowssdk.msdn.microsoft.com\/en-us\/library\/ms594866.aspx\">two<\/a>) where you can specify said workflow instance identifier. This is awesome for using WF with Service Broker, as Service Broker already has the idea of a <a href=\"http:\/\/msdn2.microsoft.com\/en-us\/library\/ms166131.aspx\">conversation group<\/a> which is roughly analogous to a <a href=\"http:\/\/windowssdk.msdn.microsoft.com\/en-us\/library\/system.workflow.runtime.workflowinstance.aspx\">workflow instance<\/a>. Conversation groups even use a Guid identifier, so there&#8217;s not even any mapping required to go from conversation group to workflow instance. <\/p>\n<p>However, things get less cool when you call <a href=\"http:\/\/windowssdk.msdn.microsoft.com\/en-us\/library\/system.workflow.runtime.workflowruntime.getworkflow.aspx\">WorkflowRuntime.GetWorkflow<\/a>. If you call GetWorkflow with a Guid that has no corresponding workflow instance, it throws an InvalidOperationException instead of just returning null. That seems like an odd choice. If you&#8217;re going to support specifying the instance identifier when you create the workflow instance, doesn&#8217;t it make sense that you should also gracefully support the scenario where an instance identifier is invalid?<\/p>\n<p>I see two ways to deal with this:<\/p>\n<ul>\n<li>Iterate through the list of <a href=\"http:\/\/windowssdk.msdn.microsoft.com\/en-us\/library\/system.workflow.runtime.workflowruntime.getloadedworkflows.aspx\">loaded<\/a> and <a href=\"http:\/\/windowssdk.msdn.microsoft.com\/en-us\/library\/system.workflow.runtime.hosting.sqlworkflowpersistenceservice.getallworkflows.aspx\">persisted<\/a> workflow instances\u00a0looking for the one in question.<\/li>\n<li>Call GetWorkflow and swallow the exception.<\/li>\n<\/ul>\n<p>I ended up picking the &#8220;Swallow the Exception&#8221; approach as I can&#8217;t imagine the iteration thru every loaded and persisted instance would be very performant. But swallowing exceptions always makes me feel icky. I&#8217;m a fan of the &#8220;exceptions only for exceptional situations&#8221; approach and as far as I&#8217;m concerned, an invalid instance identifier isn&#8217;t that exceptional. Still, it&#8217;s a minor annoyance, especially given how cool it is to be able to specify the workflow instance identifier in the first place.<\/p>\n","excerpt":"<p>One of the cool things about WF is that you can specify the Guid it uses to identify a workflow instance. WorkflowRuntime.CreateWorkflow\u00a0has an overload (actually two) where you can specify said workflow instance identifier. This is awesome for using WF with Service Broker, as Service Broker already has the idea of a conversation group which [&hellip;]<\/p>\n","date":"2006-11-03 12:36:39","modified":"2006-11-03 12:36:39","categories":[{"id":204,"slug":"development","title":"Development","description":"","parent":0,"post_count":165}],"tags":[{"id":320,"slug":"service-broker","title":"Service Broker","description":"","post_count":14},{"id":268,"slug":"wf","title":"WF","description":"","post_count":21}],"author":{"id":1,"slug":"admin","name":"DevHawk","first_name":"Harry","last_name":"Pierson","nickname":"DevHawk","url":"","description":""},"comments":[{"id":2423,"name":"Ingo Rammer","url":"","date":"2006-11-03 13:10:25","content":"<p>I&#8217;d respectfully tend to disagree. I am a firm believer in the idea that exceptions should be thrown when a method can&#8217;t perform the operation which is implied by its name. (This is a bit more concrete than the &#8220;exceptional condition&#8221;). Which now means that the semantic implication of &#8220;get&#8221; (as in GetWorkflow) is the thing we&#8217;d need to argue about. Here, I usually tend to prefer the pattern that get\/load\/retrieve-methods do indeed throw an exception if the can&#8217;t get the specified item (after all, they couldn&#8217;t do what their name implies) whereas methods like FindWorkflow() &#8211; if they would exist &#8211; would happily return empty lists if there were no matches for the given criteria. In essence, I would have expected the WF runtime to perform this operation exactly in the way it does.<\/p>\n<p>Just my 2c,<br \/>\n-Ingo<\/p>\n","parent":0}],"attachments":[],"comment_count":1,"comment_status":"closed","custom_fields":{"dasblog_entryid":["e42581ae-6d27-4c06-8a28-f77432ddfcc4"],"dasblog_compressedtitle":["Slight+Workflow+Annoyance"],"dasblog_compressedtitleunique":["2006\/11\/03\/Slight+Workflow+Annoyance"]}},"previous_url":"http:\/\/devhawk.net\/2006\/11\/01\/the-two-types-of-service-architects\/","next_url":"http:\/\/devhawk.net\/2006\/11\/07\/certainly-not-politics-as-usual\/"}