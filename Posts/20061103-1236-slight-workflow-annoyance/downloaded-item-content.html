<p>One of the cool things about WF is that you can specify the Guid it uses to identify a workflow instance. <a href="http://windowssdk.msdn.microsoft.com/en-us/library/system.workflow.runtime.workflowruntime.createworkflow.aspx">WorkflowRuntime.CreateWorkflow</a>&nbsp;has an <a href="http://windowssdk.msdn.microsoft.com/en-us/library/ms594870.aspx">overload</a> (actually <a href="http://windowssdk.msdn.microsoft.com/en-us/library/ms594866.aspx">two</a>) where you can specify said workflow instance identifier. This is awesome for using WF with Service Broker, as Service Broker already has the idea of a <a href="http://msdn2.microsoft.com/en-us/library/ms166131.aspx">conversation group</a> which is roughly analogous to a <a href="http://windowssdk.msdn.microsoft.com/en-us/library/system.workflow.runtime.workflowinstance.aspx">workflow instance</a>. Conversation groups even use a Guid identifier, so there&#8217;s not even any mapping required to go from conversation group to workflow instance. </p>
<p>However, things get less cool when you call <a href="http://windowssdk.msdn.microsoft.com/en-us/library/system.workflow.runtime.workflowruntime.getworkflow.aspx">WorkflowRuntime.GetWorkflow</a>. If you call GetWorkflow with a Guid that has no corresponding workflow instance, it throws an InvalidOperationException instead of just returning null. That seems like an odd choice. If you&#8217;re going to support specifying the instance identifier when you create the workflow instance, doesn&#8217;t it make sense that you should also gracefully support the scenario where an instance identifier is invalid?</p>
<p>I see two ways to deal with this:</p>
<ul>
<li>Iterate through the list of <a href="http://windowssdk.msdn.microsoft.com/en-us/library/system.workflow.runtime.workflowruntime.getloadedworkflows.aspx">loaded</a> and <a href="http://windowssdk.msdn.microsoft.com/en-us/library/system.workflow.runtime.hosting.sqlworkflowpersistenceservice.getallworkflows.aspx">persisted</a> workflow instances&nbsp;looking for the one in question.</li>
<li>Call GetWorkflow and swallow the exception.</li>
</ul>
<p>I ended up picking the &#8220;Swallow the Exception&#8221; approach as I can&#8217;t imagine the iteration thru every loaded and persisted instance would be very performant. But swallowing exceptions always makes me feel icky. I&#8217;m a fan of the &#8220;exceptions only for exceptional situations&#8221; approach and as far as I&#8217;m concerned, an invalid instance identifier isn&#8217;t that exceptional. Still, it&#8217;s a minor annoyance, especially given how cool it is to be able to specify the workflow instance identifier in the first place.</p>
