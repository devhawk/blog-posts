{"status":"ok","post":{"id":1256,"type":"post","slug":"updated-powershell-scripts","url":"http:\/\/devhawk.net\/2009\/04\/29\/updated-powershell-scripts\/","status":"publish","title":"Updated Powershell Scripts","title_plain":"Updated Powershell Scripts","content":"<p>For those who are interested, I just uploaded a bunch of changes to the <a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/browse.aspx\/DevHawk%20Content\/Powershell\">PowerShell Scripts folder<\/a> on my SkyDrive. Feel free to download them and use them as you need.<\/p>\n<ul>\n<li><a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/Powershell\/find-to-set-alias.ps1\">find-to-set-alias<\/a> \u2013 Brad Wilson <a href=\"http:\/\/bradwilson.typepad.com\/blog\/2008\/12\/find-to-set-aliasps1.html\">enhanced this function significantly<\/a> and broke it out into it\u2019s own script. I had a small issue with his version where the folder search may only return a single value, so you can\u2019t treat it like collection. My version wraps that command in @(\u2026) so that you can always treat it like a collection.<\/li>\n<li><a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/Powershell\/find-in-path.ps1\">find-in-path<\/a> \u2013 searches all the folders in your path for a given file name (wildcards supported. Very useful for \u201cwhere is this app actually installed\u201d kind of debugging.<\/li>\n<li><a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/Powershell\/get-git-branch.ps1\">get-git-branch<\/a> \u2013 returns the current git branch of a given folder. Got the idea for this originally from <a href=\"http:\/\/flanders.co.nz\/2009\/03\/19\/pimp-your-command-line-for-git\/\">Ivan Porto Carrero<\/a>.<\/li>\n<li><a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/Powershell\/prompt.ps1\">prompt<\/a> \u2013 my powershell prompt. Pretty basic, but it now shows current git branch.<\/li>\n<li><a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/Powershell\/elevate-process.ps1\">elevate-process<\/a> \u2013 create a new PowerShell window or run an app as an administrator. I alias this to su on my machine. I recently reworked the \u201crun an app\u201d part of this script, so it will search the current folder and then the path to run the app you specify.<\/li>\n<li><a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/Powershell\/%7C_profile.ps1\">_profile<\/a> \u2013 this is my main profile script, which I share across multiple machines via Mesh. I reworked all my alias setting to use the new find-to-set-alias and moved setting the color of the command window to the top of the script.<\/li>\n<\/ul>\n<p><strong>Update<\/strong> \u2013 I just updated elevate-process again, adding a special clause to handle .bat and .cmd files. cmd.exe seems to ignore the working directory setting, so if your batch file relies on being run from the folder it\u2019s in, it\u2019ll break with elevate-process. That\u2019s annoying. So if you elevate a batch file, the script runs cmd.exe directly and executes the specified batch file after first changing to the current directory. Ugly, but it seems to work.<\/p>\n","excerpt":"<p>For those who are interested, I just uploaded a bunch of changes to the PowerShell Scripts folder on my SkyDrive. Feel free to download them and use them as you need. find-to-set-alias \u2013 Brad Wilson enhanced this function significantly and broke it out into it\u2019s own script. I had a small issue with his version [&hellip;]<\/p>\n","date":"2009-04-29 12:25:27","modified":"2011-04-17 20:48:22","categories":[{"id":204,"slug":"development","title":"Development","description":"","parent":0,"post_count":165}],"tags":[{"id":230,"slug":"powershell","title":"PowerShell","description":"","post_count":41}],"author":{"id":1,"slug":"admin","name":"DevHawk","first_name":"Harry","last_name":"Pierson","nickname":"DevHawk","url":"","description":""},"comments":[{"id":2201,"name":"David Mohundro","url":"http:\/\/www.mohundro.com\/blog\/","date":"2009-05-11 15:26:14","content":"<p>Nice &#8211; I like the cleanness of your usage of find-to-set-alias in your prompt. Definitely makes working with versioned folders nicer.<\/p>\n<p>I&#8217;m curious, is there something your find-in-path does that the get-command cmdlet doesn&#8217;t do?<\/p>\n<p>Thanks for sharing!<\/p>\n","parent":0}],"attachments":[],"comment_count":1,"comment_status":"closed","custom_fields":{"dasblog_entryid":["2ca56559-8e23-46d4-bd05-3d89e3823545"],"dasblog_compressedtitle":["Updated+Powershell+Scripts"],"dasblog_compressedtitleunique":["2009\/04\/29\/Updated+Powershell+Scripts"]}},"previous_url":"http:\/\/devhawk.net\/2009\/04\/24\/__clrtype__-metaclasses-demo-silverlight-databinding\/","next_url":"http:\/\/devhawk.net\/2009\/05\/03\/the-save\/"}