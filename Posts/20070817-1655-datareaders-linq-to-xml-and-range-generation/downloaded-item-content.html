<p>I&#8217;m doing a bunch of database / XML stuff @ work, so I decided to use to <a href="http://msdn2.microsoft.com/en-us/vstudio/aa700831.aspx" target="_blank">VS08 beta 2</a> so I can use LINQ. For reasons I don&#8217;t want to get into, I needed a way to convert arbitrary database rows, read using a SqlDataReader, into XML. LINQ to SQL was out, since the code has to work against arbitrary tables (i.e. I have no compile time schema knowledge). But <span style="text-decoration: line-through;">XLinq</span> LINQ to XML helped me out a ton. Check out this example:</p>
<pre class="brush: csharp">const string ns = &quot;{http://some.sample.namespace.schema}&quot;;

while (dr.Read())
{
    XElement rowXml = new XElement(ns + tableName,
        from i in GetRange(0, dr.FieldCount)
        select
            new XElement(ns + dr.GetName(i), dr.GetValue(i)));
}</pre>
<p>That&#8217;s pretty cool. The only strange thing in there is the GetRange method. I needed an easy way to build a range of integers from zero to the number of fields in the data reader. I wasn&#8217;t sure of any standard way, so I wrote this little two line function:</p>
<pre class="brush: csharp">IEnumerable&lt;int&gt; GetRange(int min, int max)
{
    for (int i = min; i &lt; max; i++)
        yield return i;
}</pre>
<p>It&#8217;s simple enough, but I found it strange that I couldn&#8217;t find a standard way to generate a range with a more elegant syntax. Ruby has standard range syntax that looks like (1..10), but I couldn&#8217;t find the equivalent C#. Did I miss something, or am I really on my own to write a GetRange function?</p>
<p><span style="text-decoration: underline;">Update</span> &#8211; As expected, I missed something. John Lewicki pointed me to the static <a href="http://msdn2.microsoft.com/en-us/library/system.linq.enumerable.range(VS.90).aspx">Enumerable.Range</a> method that does exactly what I needed.</p>
