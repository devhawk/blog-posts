<p>Not much blogging of late. Trend likely to continue. Details at 11.</p>
<p>However, I did make an interesting discovery about <a href="http://www.microsoft.com/windowsserver2003/technologies/sharepoint/default.mspx"> Windows SharePoint Services</a> I wanted to share. Obviously, I&#8217;ve been thinking WSS in terms of blogging (hence the <a href="prj_sharepointsynd.aspx"> project</a> to expose RSS from WSS). However, I&#8217;ve been frustrated by what should be a simple little thing. WSS includes a rich text editor that enables me to write content that&#8217;s bold, italics, colored, fonted, sized, indented, bulleted, etc. However, until today, I couldn&#8217;t figure out how to do hyperlinks. WSS will automagically render a url as a hyperlink. But there was no way to build an anchor tag hyperlink, so your forced to embed urls directly in the text. I didn&#8217;t like that, so I set about trying to fix it. Turns out to not be a big deal.</p>
<p>It turns out that the <a href="http://msdn.microsoft.com/library/en-us/spptsdk/html/tscSPFieldMultiLineText.asp"> SPFieldMultiLine</a> class supports a property named <a href="http://msdn.microsoft.com/library/en-us/spptsdk/html/tspSPFieldMultiLineTextAllowHyperlink.asp"> AllowHyperlinks</a>. If you can flip this bit, the rich text editor in WSS will suddenly get a Hyperlink button and enable the creation of anchor tag hyperlinks. Unfortunately, there doesn&#8217;t appear to be any way to flip this bit via the existing UI as of B2TR (no, even though I work at MSFT, I don&#8217;t have the RTM bits yet). So I built a web app (as per <a href="http://msdn.microsoft.com/library/en-us/spptsdk/html/tsovVSNETIntro.asp"> these instructions</a>) that programmatically flipped that bit via the WSS object model. I also could have done it via a console or windows form app, again via the WSS object model. However, that object model only works on the WSS machine itself &#8211; there&#8217;s no concept of remoting via the OM. But WSS does expose much of its functionality remotely via web services, including a <a href="http://msdn.microsoft.com/library/en-us/spptsdk/html/soapcLists.asp"> List web service</a>.</p>
<p>The WSS Web Service interface (WSI?) is a little funky, but I munged up a little utility to flip the AllowHyperlinks property programmatically. The inputs and outputs of the service are XML (actually an XML grammar called <a href="http://msdn.microsoft.com/library/en-us/spptsdk/html/SPPTWSSCAML.asp"> CAML</a>) so the inputs and outputs of the service proxy are XmlNodes. The DOM is an ugly way to build XML documents, so I used Chris Lovett&#8217;s <a href="http://gotdotnet.com/Community/UserSamples/Details.aspx?SampleGuid=8F9DE8A7-FEC9-48E1-91C5-1FC569CDE11C"> XmlNodeWriter</a> utility class to get an XmlWriter interface on my XmlDocument. Other than that, the code was pretty straight forward. In pseudo-code, it looks like:</p>
<ol>
<li>Call ListServiceProxy.<a href="http://msdn.microsoft.com/library/en-us/spptsdk/html/soapmListsGetList.asp">GetList</a>(listName) to get the definition of the list in CAML</li>
<li>Use XPath to find the element that represents the field I want to change (//sp:Field[@DisplayName='fieldName'])</li>
<li>Create a new XmlDocument that contains a single method block for the field I want to change (see docs for <a href="http://msdn.microsoft.com/library/en-us/spptsdk/html/soapmListsUpdateList.asp"> UpdateList</a> for explanation). Write the CAML representation of the field into the method block. This CAML is identical to the CAML from the previous step, except that I&#8217;ve added AllowHyperlinks=&#8221;TRUE&#8217;</li>
<li>Call ListServiceProxy.UpdateList, passing in the the constructed XmlDocument as the updateFields parameter.</li>
<li>UpdateList returns an XmlNode that contains the result of the update. XPath query via method block ID to determine if the update succeeded or failed.</li>
</ol>
<p>I will post the code after I clean it up a bit. However, I don&#8217;t know when that will be.</p>
