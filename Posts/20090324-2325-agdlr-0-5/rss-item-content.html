<a href="http://github.com/jschementi/agdlr"><img style="display: inline; margin-left: 0px; margin-right: 0px; border: 0px;" title="agdlr-400" src="http://s3.amazonaws.com/devhawk_images/WindowsLiveWriter/AgDLR0.5_1433D/agdlr-400_3.png" border="0" alt="agdlr-400" width="240" height="98" align="right" /></a> I <a href="http://devhawk.net/2009/03/23/IronRuby+03.aspx">mentioned yesterday</a> that it looked like a new release of <a href="http://github.com/jschementi/agdlr">AgDLR</a> was eminent and sure enough <a href="http://sdlsdk.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25120">here it is</a>. There are some really cool new features including Silverlight 3 Transparent Platform Extension support, In-Browser REPL and In-Browser testing of Silverlight apps. As with IronRuby 0.3, Jimmy <a href="http://feedproxy.google.com/~r/jimmy-thinking/~3/MB3l79dtHsM/silverlight-dynamic-languages-sdk-05.html">has the a summary</a> of the new AgDLR release.

One feature of the new release I did want to highlight was <a href="http://github.com/jschementi/agdlr/blob/8a5693bb19d08f09b509d61d14733e0a7411b593/src/Chiron/XapHttpHandler.cs">XapHttpHandler</a> because I’m the one who wrote it! :)

The Silverlight versions of IronPython and IronRuby ship with a tool called <a href="http://www.codeplex.com/sdlsdk/Wiki/View.aspx?title=Chiron&amp;referringTitle=Getting%20Started">Chiron</a> that provides a REPL-esque experience for building dynamic language Silverlight apps. John Lam had <a href="http://www.iunknown.com/2008/03/dynamic-silverl.html">a good write-up on Chiron</a> when we first released it last year, but basically the idea is that Chiron is a local web server that will auto-generate a <a href="http://blogs.msdn.com/katriend/archive/2008/03/16/silverlight-2-structure-of-the-new-xap-file-silverlight-packaged-application.aspx">Silverlight XAP</a> from a directory of Python and/or Ruby files on demand. For example, if your HTML page requests a Silverlight app named app.xap, Chiron automatically creates the app.xap file from the files in the app directory. This lets you simply edit your Python and/or Ruby files directly then refresh your browser to get the new version without needing an explicit build step.

The problem is that, unlike IIS and the ASP.NET Development Server, Chiron doesn’t integrate with ASP.NET. So it’s fine for building Silverlight apps that stand alone or talk to 3rd party services. But if you want to build a Silverlight app that talks back to it’s ASP.NET host, you’re out of luck. That’s where XapHttpHandler comes in. XapHttpHandler does the same exact on-demand XAP packaging for dynamic language Silverlight applications that Chiron does, but it’s implemented as an <a href="http://msdn.microsoft.com/en-us/library/system.web.ihttphandler.aspx">IHttpHandler</a> so it plugs into the standard ASP.NET pipeline. All you have to do is put the Chiron.exe in your web application’s bin directory and <a href="http://github.com/jschementi/agdlr/blob/63a5ea3cf94068b87273531b5c96d84d8de983d2/utilities/chiron-http-handler/ChironHttpHandler.SampleSite/web.config#L86">add XapHttpHandler to your web.config</a> like so:
<pre class="brush:xml">&lt;configuration&gt;
  &lt;!--remaining web.config content ommitted for clarity--&gt;
  &lt;system.web&gt;
    &lt;httpHandlers&gt;
      &lt;add verb="*" path="*.xap" validate="false" 
           type="Chiron.XapHttpHandler,Chiron"/&gt;
    &lt;/httpHandlers&gt;
  &lt;system.web&gt;
&lt;/configuration&gt;</pre>
The new AgDLR drop includes <a href="http://github.com/jschementi/agdlr/tree/63a5ea3cf94068b87273531b5c96d84d8de983d2/utilities/chiron-http-handler/ChironHttpHandler.SampleSite">a sample website</a> that shows XapHttpHandler in action.

Quick note of caution: by design, XapHttpHandler does not cache the XAP file - it’s generated anew on every request. So I would highly recommend <span style="text-decoration: underline;">against</span> using XapHttpHandler on a production web server. You’re much better off using Chiron to build a physical XAP file that you then deploy to your production web server.