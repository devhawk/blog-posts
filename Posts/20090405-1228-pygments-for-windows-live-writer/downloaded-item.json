{"status":"ok","post":{"id":1242,"type":"post","slug":"pygments-for-windows-live-writer","url":"http:\/\/devhawk.net\/2009\/04\/05\/pygments-for-windows-live-writer\/","status":"publish","title":"Pygments for Windows Live Writer","title_plain":"Pygments for Windows Live Writer","content":"<p>For the past few years, I\u2019ve used the <a href=\"http:\/\/codehtmler.codeplex.com\/\">CodeHTMLer plugin<\/a> for Windows Live Writer for the code snippets in my blog. However, recently I discovered the <a href=\"http:\/\/pygments.org\/\">Pygments<\/a> Python syntax highlighter package which supports scores more languages than CodeHTMLer does. It also support multiple color schemes and was easily extensible so I could build an HTML formatter that didn\u2019t use &lt;pre&gt; tags (which <a href=\"http:\/\/devhawk.net\/2007\/12\/07\/Blogging+F+Code.aspx\">I\u2019ve found DasBlog has issues with<\/a> in the RSS feed, though honestly I\u2019m running three minor releases behind the latest DasBlog release). IronPython supports Pygments just fine \u2013 at least, the one IPy bug that Pygments exposes has a simple workaround \u2013 so I set about building a Windows Live Writer plugin that uses it.<\/p>\n<p>If you\u2019re simply interested in the plugin itself, you can <a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/Pygments%20for%20WL%20Writer\/Pygments.WLWriter.msi\">get it from my skydrive<\/a>. The <a href=\"http:\/\/github.com\/devhawk\/pygments.wlwriter\">source is up on GitHub<\/a>. For now, if you find any bugs, please leave a comment on this post. If there\u2019s enough interest I\u2019ll setup a site somewhere (CodePlex perhaps) where I can track bugs and feature requests.<\/p>\n<p>Pygments for WL Writer is a <a href=\"http:\/\/msdn.microsoft.com\/en-us\/library\/aa702799.aspx\">smart content source<\/a>. In WL Writer\u2019s terminology, that means when you click inserted text in the editor window, it is treated as an atomic entity which you can then edit by using the Edit Code button in the Pygments for WL Writer sidebar editor. I I often found that I would edit my code multiple times \u2013 usually to shorten lines so they\u2019d fit on my blog without wrapping. CodeHTMLer for WL Writer is a standard content source, so it just spews the formatted code as HTML onto the page.<\/p>\n<p>From an IronPython perspective, there\u2019s some interesting stuff there. I decided to compile the pygments library into a DLL for easier distribution. If you look in the source, there\u2019s a <a href=\"http:\/\/github.com\/devhawk\/pygments.wlwriter\/tree\/5684d8e936921e9f79ab3e3f08bd1570e48a8a51\/pygments_package\">folder<\/a> for the Pygments source as well as the <a href=\"http:\/\/github.com\/devhawk\/pygments.wlwriter\/tree\/5684d8e936921e9f79ab3e3f08bd1570e48a8a51\/pygments_package\/pygments_dependencies\">parts of the standard Python library<\/a> that Pygments depends on and my <a href=\"http:\/\/github.com\/devhawk\/pygments.wlwriter\/blob\/5684d8e936921e9f79ab3e3f08bd1570e48a8a51\/pygments_package\/devhawk_formatter.py\">custom HTML formatter<\/a>. Those all get compiled <a href=\"http:\/\/github.com\/devhawk\/pygments.wlwriter\/blob\/5684d8e936921e9f79ab3e3f08bd1570e48a8a51\/pygments_package\/build_pygments.py\">via a custom script<\/a> which can be called by the <a href=\"http:\/\/github.com\/devhawk\/pygments.wlwriter\/blob\/5684d8e936921e9f79ab3e3f08bd1570e48a8a51\/build.bat\">build.bat file<\/a> in the project root. <\/p>\n<p>Some features I\u2019m thinking about adding:<\/p>\n<ul>\n<li>An extensibility model so that you can add new languages by dropping new <a href=\"http:\/\/pygments.org\/docs\/lexerdevelopment\/\">Pygments lexers<\/a> into the same folder the plugin is installed to. Pygments supports lots of languages, but not all of them \u2013 notably it\u2019s missing Powershell and F#. <\/li>\n<li>Support for new HTML formatters and color schemes using the same extensibility mechanism described above.<\/li>\n<li>Support for selecting an HTML formatter.<\/li>\n<li>Improving the code editor window. Currently, I\u2019m using a standard WinForms multi-line TextBox, but that leaves a lot to be desired. With the Python work I do, I often need to be able to select a bunch of text and change it\u2019s indenting via tab and shift-tab. If anyone has a suggestion for a good WinForms text editing control, <a href=\"mailto:harry@devhawk.net\">let me know<\/a>.<\/li>\n<li>Being able to specify the font and size of the Pygmented code.<\/li>\n<li>Storing user preferences \u2013 remembering the most recent syntax and color scheme the user used.<\/li>\n<\/ul>\n<p>Feedback, as always is appreciated. I\u2019ll probably write a few posts about the project when I get a chance, so let me know if there\u2019s anything you\u2019re dying to hear about.<\/p>\n","excerpt":"<p>For the past few years, I\u2019ve used the CodeHTMLer plugin for Windows Live Writer for the code snippets in my blog. However, recently I discovered the Pygments Python syntax highlighter package which supports scores more languages than CodeHTMLer does. It also support multiple color schemes and was easily extensible so I could build an HTML [&hellip;]<\/p>\n","date":"2009-04-05 12:28:51","modified":"2009-04-05 12:28:51","categories":[{"id":252,"slug":"ironpython","title":"IronPython","description":"","parent":0,"post_count":99}],"tags":[{"id":207,"slug":"windows-live","title":"Windows Live","description":"","post_count":29},{"id":280,"slug":"windows-live-writer","title":"Windows Live Writer","description":"","post_count":3}],"author":{"id":1,"slug":"admin","name":"DevHawk","first_name":"Harry","last_name":"Pierson","nickname":"DevHawk","url":"","description":""},"comments":[{"id":2192,"name":"Julian Birch","url":"http:\/\/www.colourcoding.net\/","date":"2009-04-22 08:34:28","content":"<p>Hi, maybe I&#8217;m doing something stupid, but the install doesn&#8217;t seem to registered the plug-in.<\/p>\n<p>Looking forward to trying it out.<\/p>\n<p>Julian.<\/p>\n","parent":0}],"attachments":[],"comment_count":1,"comment_status":"closed","custom_fields":{"dasblog_entryid":["ac85783f-50b0-4b88-9daf-ced4546104f0"],"dasblog_compressedtitle":["Pygments+For+Windows+Live+Writer"],"dasblog_compressedtitleunique":["2009\/04\/05\/Pygments+For+Windows+Live+Writer"]}},"previous_url":"http:\/\/devhawk.net\/2009\/04\/01\/writing-an-ironpython-debugger-command-routing\/","next_url":"http:\/\/devhawk.net\/2009\/04\/06\/writing-an-ironpython-debugger-getting-arguments\/"}