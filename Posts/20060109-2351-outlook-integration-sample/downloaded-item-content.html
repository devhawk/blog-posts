<p>For the past few months, I&#8217;ve been heavily involved in a project but I wasn&#8217;t allowed to blog about it. Last week, it went live on MSDN so finally the gag is off.</p>
<p>About a year ago, word <a href="http://news.com.com/Microsoft+turns+to+Elixir+for+Office+boost/2100-1012_3-5545640.html">started to surface</a> about something called <a href="http://news.com.com/Gates+pours+Elixir+for+Office+developers/2100-1012_3-5563873.html">Project Elixir</a> which aimed to integrate back end CRM systems with Microsoft Outlook. Part of that effort resulted in the addition of <a href="http://msdn.microsoft.com/office/understanding/vsto/default.aspx?pull=/library/en-us/odc_vsto2005_ta/html/officewhatsnewinvsto2005.asp#officewhatsnewinvsto2005_outlookmanagedaddins">Outlook Managed Add-ins</a> to <a href="http://msdn.microsoft.com/office/understanding/vsto/default.aspx?pull=/library/en-us/odc_vsto2005_ta/html/officewhatsnewinvsto2005.asp">Visual Studio 2005 Tools for Office</a>. However, the VSTO team&#8217;s primary deliverable was an add-in loader that enforced security, enabled shutdown unloading and provided a better startup/shutdown developer experience that IDTExtensibility2. (Check out the <a href="http://msdn.microsoft.com/library/en-us/odc_vsto2005_ta/html/Office_VSTOOutlookAdd-inArchitecture.asp">VSTO Outlook Architecture document</a> for more details.) While those are important fundamentals that needed to be gotten right, VSTO Outlook doesn&#8217;t provide much in the way of tools or guidance for building Outlook add-ins that leverage managed forms and controls or integrate with your back end systems. That&#8217;s where the <a href="http://www.microsoft.com/downloads/details.aspx?familyid=078124E9-1E88-4F51-8C98-3C1999CFE743&displaylang=en">CRM Integration for Outlook sample</a> comes in.</p>
<p>What we&#8217;ve built is a sample application that surfaces CRM style data inside of Outlook. Outlook is the natural home for your calendar and your personal contacts. Why not make it the natural home for your customer contacts, activities and opportunities as well? As part of the demo project we&#8217;ve implemented:</p>
<ul>
<li>Using Windows Forms for editing custom items. Check out this <a class="grouped_elements" href="http://msdn.microsoft.com/library/en-us/dnbda/html/otlklobcrm10.gif" rel="tc-fancybox-group670">screenshot</a>. The Activity form is a standard managed Windows Forms form, not an Outlook custom form.
</li>
<li>Using a Windows Forms user control as a folder home page. Here&#8217;s a <a class="grouped_elements" href="http://msdn.microsoft.com/library/en-us/dnbda/html/otlklobcrm09.gif" rel="tc-fancybox-group670">screenshot</a> of the &#8220;CRM Today&#8221; page. Again, that&#8217;s a standard managed Windows Forms user control.
</li>
<li>A framework for adding menu items and toolbars. In Outlook, the developer has to manage adding the custom toolbars and menu to each explorer and inspector window themselves. With our sample, we built a framework to handle that for you.
</li>
<li>Using SQL Express as a local cache of CRM data. It turns out that for many scenarios, storing a copy of all the back-end data directly in Outlook is a bad idea. First, it increases the size of the users mailbox, requiring more storage on the Exchange server. Furthermore, any custom data in Outlook has to be synced twice &#8211; once from the back end system to Outlook on the desktop, then from Outlook back to Exchange. By minimizing the amount of back-end data stored in Outlook proper, we reduce the mailbox size and sync bandwidth needs. In both the above screenshots, the displayed data is coming out of the local SQL Express instance, not Outlook.
</li>
<li>Having two separate storage locations (Outlook &amp; SQL Express) means having to sync between them. We&#8217;ve built a local sync engine that can sync both individual items between Outlook and SQL Express as well as a collection of items between SQL Express and a given Outlook folder.
</li>
<li>Finally, there are some utility classes to make it easier to deal with Outlook folders and items. Of primary note is the ItemAdapter class which provides a pseudo base class for Outlook items (appointments, emails, tasks, etc). Those items all have a set of similar properties and methods, but don&#8217;t have a common base class so they can&#8217;t be treated polymorphicaly. ItemAdapter uses runtime reflection to implement those common operations without needing to cast to the concrete Outlook item type. </li>
</ul>
<p>Check out the <a href="http://msdn.microsoft.com/architecture/default.aspx?pull=/library/en-us/dnbda/html/OtlkLOBCRM.asp">Architecture Design Guide</a>, as well as the <a href="http://msdn.microsoft.com/architecture/default.aspx?pull=/library/en-us/dnbda/html/OtlkCustInEntApp.asp">Outlook Customization Guide</a> and the <a href="http://msdn.microsoft.com/architecture/default.aspx?pull=/library/en-us/dnbda/html/OtlkLDSSynch.asp">Local Sync Engine Guide</a> up on the Solution Architecture Center. You can also pick up the <a href="http://www.microsoft.com/downloads/details.aspx?familyid=078124E9-1E88-4F51-8C98-3C1999CFE743&displaylang=en">source code</a>. Also, I spun up a <a href="http://workspaces.gotdotnet.com/outlookintegration">GDN Workspace</a> so we can have a <a href="http://www.gotdotnet.com/workspaces/messageboard/home.aspx?id=ccecaaa6-88a8-43c0-8880-a491fcf7396e">discussion forum</a> and to <a href="http://www.gotdotnet.com/workspaces/bugtracker/home.aspx?id=ccecaaa6-88a8-43c0-8880-a491fcf7396e">track bugs and requests</a>. </p>
<p>Going forward, I&#8217;m going to be focusing on the remote data sync story for this scenario. Among other responsibilities, I &#8220;own&#8221; the Data pillar of our <a href="http://blogs.msdn.com/gianpaolo/archive/2005/06/07/426609.aspx">Connected Systems model</a> so this dovetails nicely. You&#8217;ll note above that while we have a local sync engine in the sample, we don&#8217;t have any way to move the data back and forth between the local copy in SQL Express and the remote copy in the CRM back-end. We are working on some guidance around this right now, but we didn&#8217;t want to hold up publishing the rest of the sample. </p>
<p>Frankly, it&#8217;s been nice to be involved with something so technical after spending time on the marketing team. I&#8217;m pretty proud of the project and I look forward to your feedback. </p>
<p><strong>Update</strong>: Removed the link to the running demo as it&#8217;s been taken off the download site for reasons I am not aware of. If you want the binary and you don&#8217;t know how to compile it, drop me a mail.</p>
