<?xml version="1.0" encoding="utf-8"?>
<wp:comment xmlns:wp="http://wordpress.org/export/1.2/">
  <wp:comment_id>2147</wp:comment_id>
  <wp:comment_author><![CDATA[Lukas Cenovsky]]></wp:comment_author>
  <wp:comment_author_email>cenovsky@bakalari.cz</wp:comment_author_email>
  <wp:comment_author_url>http://gui-at.blogspot.com/</wp:comment_author_url>
  <wp:comment_author_IP>195.250.144.226</wp:comment_author_IP>
  <wp:comment_date>2008-11-27 09:37:30</wp:comment_date>
  <wp:comment_date_gmt>2008-11-27 17:37:30</wp:comment_date_gmt>
  <wp:comment_content><![CDATA[The threading is still kind of mystery for me. Especially when something works for me which shouldn't according to others.

Your first point is correct - I use WinForms instead of WPF. I also use IronPython 1.1.1 on .NET 2.0.50727.3053.

I do not call methods on WinForms. I only read properties because I simulate all methods via Win32 API calls. For example, when I want to click button, I send mouse click event to the position of the button. 

Interestingly, when I directly call OnClick method of a button, the method runs OK and the button is clicked. For example, using http://gui-at.cendaweb.cz/GUIAT_PoC.exe run:

IronPython 1.1.1 (1.1.1) on .NET 2.0.50727.3053
Copyright (c) Microsoft Corporation. All rights reserved.
>>> import clr
>>> clr.AddReference('System')
>>> clr.AddReference("System.Windows.Forms")
>>> from System import *
>>> from System.Reflection import *
>>> from System.Threading import *
>>> from System.Windows.Forms import Application
>>> from time import sleep
>>>
>>> def RunMeCallBack(var):
...     global App
...     asm = Assembly.LoadFrom('GUIAT_PoC.exe')
...     asm_type = asm.GetType('GUIAT_PoC.frmGUIAT')
...     App = Activator.CreateInstance(asm_type)
...     Application.Run(App)
...
>>> App = None
>>> ThreadPool.QueueUserWorkItem(WaitCallback(RunMeCallBack))

Wait a moment until the app is loaded and run:
>>> App.Controls[2].Text = 'text'
>>> App.Controls[0].OnClick(None)

The 'text' is added to the listbox. Is this just a lucky chance I have or is it correct behavior? I do not know...

PS: I tried it on IronPython 20 RC2 (IronPython 2.0 (2.0.0.0) on .NET 2.0.50727.3053) now and it behaves the same.]]></wp:comment_content>
  <wp:comment_approved>1</wp:comment_approved>
  <wp:comment_type></wp:comment_type>
  <wp:comment_parent>0</wp:comment_parent>
  <wp:comment_user_id>0</wp:comment_user_id>
</wp:comment>