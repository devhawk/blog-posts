<p>So I want to start kicking the <a href="http://msdn.microsoft.com/library/en-us/dnanchor/html/anch_p2p.asp">P2P SDK</a> around again. However, most of my work to date is on my <a href="http://devhawk.net/PermaLink.aspx?guid=1ac7e57e-8109-4dff-bffb-bde71a26382e">busted laptop</a> that I am <em>still </em>waiting to get fixed. Rather than reinvent the wheel, I started looking at wrapping two other relevant SDKs: <a href="http://msdn.microsoft.com/library/en-us/iphlp/iphlp/ip_helper_start_page.asp">IP Helper</a> and <a href="http://msdn.microsoft.com/library/en-us/dnanchor/html/intconnsharingfirewall.asp">Internet Connection Sharing &amp; Firewall</a>. IP Helper allows access to the network configuration of the local computer (including IPv6 settings). ICS/F allows you to programmatically manage XP&#8217;s NAT and firewall functionallity (including the IPv6 firewall). Both are relevant to P2P due to the management of IPv6.</p>
<p>I&#8217;m not sure why these systems have a custom API instead of just using <a href="http://msdn.microsoft.com/library/en-us/dnanchor/html/anch_wmi.asp">WMI</a>, but they do. So I&#8217;m looking to wrap them either in managed code or WMI (which is then available to managed code via <a href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfSystemManagement.asp">System.Management</a>). </p>
<p><strong>UPDATE</strong>: MSFT just published a <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=4454e0e1-61fa-447a-bdcd-499f73a637d1&DisplayLang=en">document</a> about the new Windows Firewall in XP SP2. One of the big new features is the ability to configure the firewall at the global scope., though you can still specify connection settings which override the global settings. SP2 also includes the IPv6 firewall that is a part of the <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=E88CC382-8CE6-4739-97C0-1A52A6F005E4&displaylang=en">Advanced Networking Pack</a>&nbsp;(which may mean that the P2P infrastructure is baked into SP2). I&#8217;m sure this will imply changes to the ICF API.</p>
<p><strong>UPDATE 2</strong>: I finally got my laptop back today, and I found my previous P2P work. I hope to kick some code around over the holidays.</p>
