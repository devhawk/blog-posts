<?xml version="1.0" encoding="utf-8"?>
<item>
  <title>Webdev Script and KillWebDevServer</title>
  <link>http://devhawk.net/2008/09/12/webdev-script-and-killwebdevserver/</link>
  <pubDate>Fri, 12 Sep 2008 17:53:41 +0000</pubDate>
  <dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">devhawk</dc:creator>
  <guid isPermaLink="false">http://7781e275-7468-40cb-8f1a-fd28c2edcc78</guid>
  <description></description>
  <content:encoded xmlns:content="http://purl.org/rss/1.0/modules/content/"><![CDATA[<p>I was updating <a href="http://devhawk.net/2008/03/20/WebDevWebServer+PowerShell+Function.aspx">my webdev powershell script</a> today. I wanted to add support for a -browser switch that would automatically launch a browser window the way chiron from the <a href="http://codeplex.com/sdlsdk">Silverlight Dynamic Languages SDK</a>. does. I also set the script to serve up the current directory by default. I posted <a href="http://cid-0d9bc809858885a4.skydrive.live.com/self.aspx/DevHawk%20Content/Powershell/webdev.ps1">the new version</a> up on my SkyDrive.</p><p>While I was working on the script, I thought about how one might shutdown the WebDev server from the command line. That turned out to be much harder. Basically, you have to look thru all the top level windows for one that has "ASP.NET Development Server" in the window text, then you send that window two messages - WM_QUERYENDSESSION and WM_QUIT. Not sure why the WebDev server uses WM_QUERYENDSESSION to shut down it's tray icon, but if you look at WebDev.WebServer.exe in Reflector, you'll see the tray icon form overrides WinProc in order to look for message 0x11, i.e. WM_QUERYENDSESSION.</p><p>I threw together a quick little <a href="http://cid-0d9bc809858885a4.skydrive.live.com/self.aspx/DevHawk%20Content/Utilities/KillWebDevServer.exe">C# console app</a> to shutdown the WebDev server and stuck it up on my SkyDrive as well. <a href="http://cid-0d9bc809858885a4.skydrive.live.com/self.aspx/DevHawk%20Content/Utilities/KillWebDevServer.zip">Source code</a> is up there too. I had to use a bunch of P/Invokes to make it work, or I would have written it in Powershell or IronPython.</p><p>Enjoy.</p>]]></content:encoded>
  <excerpt:encoded xmlns:excerpt="http://wordpress.org/export/1.2/excerpt/"><![CDATA[]]></excerpt:encoded>
  <wp:post_id xmlns:wp="http://wordpress.org/export/1.2/">1174</wp:post_id>
  <wp:post_date xmlns:wp="http://wordpress.org/export/1.2/">2008-09-12 17:53:41</wp:post_date>
  <wp:post_date_gmt xmlns:wp="http://wordpress.org/export/1.2/">2008-09-12 17:53:41</wp:post_date_gmt>
  <wp:comment_status xmlns:wp="http://wordpress.org/export/1.2/">open</wp:comment_status>
  <wp:ping_status xmlns:wp="http://wordpress.org/export/1.2/">open</wp:ping_status>
  <wp:post_name xmlns:wp="http://wordpress.org/export/1.2/">webdev-script-and-killwebdevserver</wp:post_name>
  <wp:status xmlns:wp="http://wordpress.org/export/1.2/">publish</wp:status>
  <wp:post_parent xmlns:wp="http://wordpress.org/export/1.2/">0</wp:post_parent>
  <wp:menu_order xmlns:wp="http://wordpress.org/export/1.2/">0</wp:menu_order>
  <wp:post_type xmlns:wp="http://wordpress.org/export/1.2/">post</wp:post_type>
  <wp:post_password xmlns:wp="http://wordpress.org/export/1.2/"></wp:post_password>
  <wp:is_sticky xmlns:wp="http://wordpress.org/export/1.2/">0</wp:is_sticky>
  <category domain="post_tag" nicename="asp-net"><![CDATA[ASP.NET]]></category>
  <category domain="post_tag" nicename="powershell"><![CDATA[PowerShell]]></category>
  <category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_entryid</wp:meta_key>
    <wp:meta_value><![CDATA[7781e275-7468-40cb-8f1a-fd28c2edcc78]]></wp:meta_value>
  </wp:postmeta>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_compressedtitle</wp:meta_key>
    <wp:meta_value><![CDATA[Webdev+Script+And+KillWebDevServer]]></wp:meta_value>
  </wp:postmeta>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_compressedtitleunique</wp:meta_key>
    <wp:meta_value><![CDATA[2008/09/13/Webdev+Script+And+KillWebDevServer]]></wp:meta_value>
  </wp:postmeta>
  <wp:comment xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:comment_id>2122</wp:comment_id>
    <wp:comment_author><![CDATA[Tomas Restrepo]]></wp:comment_author>
    <wp:comment_author_email>tomas@winterdom.com</wp:comment_author_email>
    <wp:comment_author_url>http://winterdom.com/</wp:comment_author_url>
    <wp:comment_author_IP>200.116.183.12</wp:comment_author_IP>
    <wp:comment_date>2008-09-12 18:37:09</wp:comment_date>
    <wp:comment_date_gmt>2008-09-13 01:37:09</wp:comment_date_gmt>
    <wp:comment_content><![CDATA[Hey that's pretty cool! I've become quite a regular user of your webdev script :)]]></wp:comment_content>
    <wp:comment_approved>1</wp:comment_approved>
    <wp:comment_type></wp:comment_type>
    <wp:comment_parent>0</wp:comment_parent>
    <wp:comment_user_id>0</wp:comment_user_id>
  </wp:comment>
</item>