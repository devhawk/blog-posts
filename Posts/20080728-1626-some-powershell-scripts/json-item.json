{"status":"ok","post":{"id":1159,"type":"post","slug":"some-powershell-scripts","url":"http:\/\/devhawk.net\/2008\/07\/28\/some-powershell-scripts\/","status":"publish","title":"Some Powershell Scripts","title_plain":"Some Powershell Scripts","content":"<p>By popular demand, I uploaded a bunch of my scripts to <a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/Powershell\">my SkyDrive<\/a>. Included are:<\/p>\n<ul>\n<li><a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/Powershell\/Set%20Powershell%20Home.zip\">Set Powershell Home<\/a> &#8211; this is actually a zip file that contains the profile redirect script. Unzip this in your Documents folder and change the path in Microsoft.PowerShell_profile to where ever you want your profile and home directories to live.<\/li>\n<li><a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/Powershell\/%7C_profile.ps1\">_profile<\/a> &#8211; my &#8220;real&#8221; profile script. Note, the su function requires the <a href=\"http:\/\/technet.microsoft.com\/en-us\/magazine\/cc162321.aspx\">Script Elevation PowerToys<\/a> in order to work. Also, all the various aliases are hard coded to their location on my machine. You&#8217;ll probably want to change them.<\/li>\n<li><a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/Powershell\/prompt.ps1\">prompt<\/a> &#8211; my prompt script<\/li>\n<li><a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/Powershell\/prepend-path.ps1\">prepend-path<\/a> &#8211; a script to add a directory to start of my path<\/li>\n<li><a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/Powershell\/append-path.ps1\">append-path<\/a> &#8211; like above, but adds the directory to the end of the path<\/li>\n<li><a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/Powershell\/append-path-perm.ps1\">append-path-perm<\/a> &#8211; like append-path, but permanently updates the path in the registry <\/li>\n<\/ul>\n<p>Enjoy.<\/p>\n","excerpt":"<p>By popular demand, I uploaded a bunch of my scripts to my SkyDrive. Included are: Set Powershell Home &#8211; this is actually a zip file that contains the profile redirect script. Unzip this in your Documents folder and change the path in Microsoft.PowerShell_profile to where ever you want your profile and home directories to live. [&hellip;]<\/p>\n","date":"2008-07-28 16:26:24","modified":"2008-07-28 16:26:24","categories":[],"tags":[{"id":230,"slug":"powershell","title":"PowerShell","description":"","post_count":41}],"author":{"id":1,"slug":"admin","name":"DevHawk","first_name":"Harry","last_name":"Pierson","nickname":"DevHawk","url":"","description":""},"comments":[{"id":2092,"name":"Richard","url":"","date":"2008-07-30 10:09:10","content":"<p>From profile.ps1:<br \/>\n> cmd.exe \/c color 4f<br \/>\nYou can control the colours that PSH&#8217;s console host uses by assigning to the members of $Host.PrivateData.<br \/>\nE.g. $Host.PrivateData.WarningForegroundColor = &#8220;green&#8221;<br \/>\n(Each is of type [System]::ConsoleColor)<\/p>\n","parent":0},{"id":2093,"name":"DevHawk","url":"","date":"2008-07-30 11:32:21","content":"<p>@Richard, Thanks. However, that doesn&#8217;t appear to let me set the background for the command shell window as a whole though. Only, the Warning, Error, Debug, Verbose and Progress fore &#038; background colors. I can see the value of that, but my goal with that line of script is to set the entire background to red.<\/p>\n","parent":0},{"id":2094,"name":"Tommy Williams","url":"http:\/\/twwilliams.com\/blog\/","date":"2008-07-31 09:42:06","content":"<p>If you want to change the settings for the console, use $host.ui.rawui.foregroundcolor and .background color. I have functions like this:<\/p>\n<p>function green { $host.ui.rawui.foregroundcolor = &#8220;Green&#8221;; $host.ui.rawui.backgroundcolor = &#8220;Black&#8221; }<\/p>\n<p>function yellow { $host.ui.rawui.foregroundcolor = &#8220;Yellow&#8221;; $host.ui.rawui.backgroundcolor = &#8220;Black&#8221; }<\/p>\n","parent":0},{"id":2095,"name":"Richard","url":"","date":"2008-08-01 06:41:04","content":"<p>> However, that doesn&#8217;t appear to let me set the background for the command shell window as a whole though<\/p>\n<p>Follow it with a Clear-Host<\/p>\n<p>My current^h finally implemented elevated PSH (use scope modifiers so don&#8217;t just create a local variable in the condition block containing this):<br \/>\n$host.UI.RawUI.Backgroundcolor=&#8221;DarkGray&#8221;<br \/>\n$host.UI.RawUI.Foregroundcolor=&#8221;Red&#8221;<br \/>\nclear-host<br \/>\nwrite-host &#8220;`n** Elevated Session **`n&#8221; -foreground DarkRed -background Yellow<br \/>\n$global:ConsolePromptColour = &#8220;Red&#8221; # Override prompt function&#8217;s default<br \/>\n$global:ConfirmPreference = &#8220;Medium&#8221;<\/p>\n","parent":0},{"id":2096,"name":"DevHawk","url":"","date":"2008-08-01 13:10:52","content":"<p>Thanks Tommy and Richard! I updated my _profile script to use instead of $host.UI.RawUI.Backgroundcolor cmd.exe \/c color. <\/p>\n","parent":0}],"attachments":[],"comment_count":5,"comment_status":"closed","custom_fields":{"dasblog_entryid":["c5d2c168-4ed0-4e2e-b78f-a4ca4ba80695"],"dasblog_compressedtitle":["Some+Powershell+Scripts"],"dasblog_compressedtitleunique":["2008\/07\/28\/Some+Powershell+Scripts"]}},"previous_url":"http:\/\/devhawk.net\/2008\/07\/28\/devhawks-slightly-useful-powershell-configuration\/","next_url":"http:\/\/devhawk.net\/2008\/07\/29\/pushed-the-wrong-button\/"}