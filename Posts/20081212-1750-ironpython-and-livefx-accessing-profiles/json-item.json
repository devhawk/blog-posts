{"status":"ok","post":{"id":1204,"type":"post","slug":"ironpython-and-livefx-accessing-profiles","url":"http:\/\/devhawk.net\/2008\/12\/12\/ironpython-and-livefx-accessing-profiles\/","status":"publish","title":"IronPython and LiveFX: Accessing Profiles","title_plain":"IronPython and LiveFX: Accessing Profiles","content":"<p>I recently got access to both the <a href=\"http:\/\/www.microsoft.com\/azure\/windowsazure.mspx\">Windows Azure<\/a> and <a href=\"http:\/\/dev.live.com\/liveframework\/\">Live Framework<\/a> CTP programs. Frankly, I\u2019m very interested in <a href=\"https:\/\/www.mesh.com\">Live Mesh<\/a>, so I decided to start with a simple LiveFX program. Scott (aka <a href=\"http:\/\/www.liveside.net\/members\/ScottIsAFool\/default.aspx\">ScottIsAFool<\/a>) at <a href=\"http:\/\/www.liveside.net\">LiveSide<\/a> posted a <a href=\"http:\/\/www.liveside.net\/developer\/archive\/2008\/11\/10\/a-quick-and-dirty-console-application-using-the-livefx.aspx\">\u201cquick and dirty\u201d console app<\/a> that pulls info from a user\u2019s profile via LiveFx. It\u2019s not Mesh per se, but it does use the same framework and resource model so I decided to port it to IronPython. FYI, this app won\u2019t run unless you\u2019ve been received a LiveFx CTP token and provisioned yourself. <\/p>\n<pre class=\"brush: python\">\n#Add LiveFX References     \nimport sys     \nsys.path.append('C:\\Program Files\\Microsoft SDKs\\Live Framework SDK\\v0.9\\Libraries\\.Net Library')\n\nimport clr     \nclr.AddReference('Microsoft.LiveFX.Client')\nclr.AddReference('Microsoft.LiveFX.ResourceModel')\n\nfrom Microsoft.LiveFX.Client import LiveOperatingEnvironment     \nfrom Microsoft.LiveFX.ResourceModel.ProfileResource import ProfileType     \nfrom System.Net import NetworkCredential     \n\nfrom devhawk import linq     \n\n#get username and password from the user     \nuid = raw_input(\"Enter Windows Live ID: \")\npwd = raw_input(\"Enter Password: \")\ncreds = NetworkCredential(uid, pwd, \"https:\/\/user-ctp.windows.net\")\n\n#print out user's info     \nloe = LiveOperatingEnvironment()\nloe.Connect(creds)\n\ngeneral = linq.Single(loe.Profiles.Entries,  \n  lambda e: e.Resource.Type == ProfileType.General)\n\nprint loe.Mesh.ProvisionedUser.Name     \nprint loe.Mesh.ProvisionedUser.Email     \nprint general.Resource.ProfileInfo.PersonalStatusMessage     \nprint linq.Count(loe.Contacts.Entries)\n<\/pre>\n<p>I did modify the app slightly, reading the WLID and password off the console \u2013 I was *sure* I would accidently post my personal credentials if I left them embedded in the app. Otherwise, it\u2019s a straight port. First, I add references the LiveFX dlls. Since they\u2019re not local to my script, I add the directory where they\u2019re installed to sys.path, which lets me call clr.AddReference directly. Then I retrieve the user\u2019s ID and password using raw_input (Python\u2019s equivalent to Console.ReadLine). Finally, I connect to the user\u2019s LiveOperatingEnvironment and pull their name, email address, personal status message and the number of contacts they have. <\/p>\n<p>As per the original app, I use LINQ to find the right profile as well as count the number of contacts. I was able to reuse the linq.py file I wrote for my <a href=\"http:\/\/devhawk.net\/2008\/11\/27\/IronPython+And+Linq+To+XML+Part+2+Screen+Scraping.aspx\">Rock Band song list screen scraper<\/a> (though I did have to add the Count function since I hadn\u2019t needed it previously). I\u2019ve posted <a href=\"http:\/\/cid-0d9bc809858885a4.skydrive.live.com\/self.aspx\/DevHawk%20Content\/IronPython%20Stuff\/LiveFxPsmDemo.zip\">this script<\/a> on my SkyDrive, and it includes my most recent linq.py file.<\/p>\n<p>BTW, it doesn\u2019t appear that you can set the PersonalStatusMessage programmatically, at least not currently. I was thinking it would be cool to build an app that sets your PSM via Twitter, but the set method of PersonalStatusMessage is marked internal. In fact, all the set methods of all the profile properties I looked at are marked internal. If someone knows how to update LiveFX resource objects in the current CTP, I\u2019d appreciate it if you dropped me a line or left me a comment.<\/p>\n","excerpt":"<p>I recently got access to both the Windows Azure and Live Framework CTP programs. Frankly, I\u2019m very interested in Live Mesh, so I decided to start with a simple LiveFX program. Scott (aka ScottIsAFool) at LiveSide posted a \u201cquick and dirty\u201d console app that pulls info from a user\u2019s profile via LiveFx. It\u2019s not Mesh [&hellip;]<\/p>\n","date":"2008-12-12 17:50:08","modified":"2008-12-12 17:50:08","categories":[{"id":252,"slug":"ironpython","title":"IronPython","description":"","parent":0,"post_count":99}],"tags":[{"id":275,"slug":"live-framework","title":"Live Framework","description":"","post_count":3},{"id":207,"slug":"windows-live","title":"Windows Live","description":"","post_count":29}],"author":{"id":1,"slug":"admin","name":"DevHawk","first_name":"Harry","last_name":"Pierson","nickname":"DevHawk","url":"","description":""},"comments":[{"id":2159,"name":"Oran","url":"http:\/\/orand.blogspot.com","date":"2008-12-12 20:44:15","content":"<p>Most resources in LiveFX can be updated but Profiles are unfortunately read-only at this point.<br \/>\n<a href=\"http:\/\/social.msdn.microsoft.com\/Forums\/en-US\/liveframework\/thread\/81ab8f62-3244-4ca5-b376-2d5879f47c9f\/\" rel=\"nofollow\">http:\/\/social.msdn.microsoft.com\/Forums\/en-US\/liveframework\/thread\/81ab8f62-3244-4ca5-b376-2d5879f47c9f\/<\/a><\/p>\n<p>For another example of IronPython + LiveFX, check out this blog post from Ori Amiga, the Group PM of LiveFX.  Ori loves IronPython so if there&#8217;s anything you think of that would make LiveFX more IronPython-friendly, he would be the guy to contact.<br \/>\n<a href=\"http:\/\/blogs.msdn.com\/oriamiga\/archive\/2008\/11\/09\/livefx-using-ironpython.aspx\" rel=\"nofollow\">http:\/\/blogs.msdn.com\/oriamiga\/archive\/2008\/11\/09\/livefx-using-ironpython.aspx<\/a><\/p>\n","parent":0},{"id":2160,"name":"Vikas Ahuja","url":"http:\/\/blogs.msdn.com\/vikasahuja","date":"2008-12-13 00:47:52","content":"<p>Harry &#8211; Profiles are read only in current release as Oran pointed out. You can use forums as one of the resource at your disposal for discussion if you haven&#8217;t already using it. <\/p>\n<p>I have updated one Thread with link to your post &#8211; we community members for Live Framework keep doing it as we find blog posts about Live Framework.<\/p>\n<p><a href=\"http:\/\/social.msdn.microsoft.com\/Forums\/en-US\/liveframework\/thread\/828d9a48-239a-4af8-8239-35931e514d37\" rel=\"nofollow\">http:\/\/social.msdn.microsoft.com\/Forums\/en-US\/liveframework\/thread\/828d9a48-239a-4af8-8239-35931e514d37<\/a><\/p>\n","parent":0}],"attachments":[],"comment_count":2,"comment_status":"closed","custom_fields":{"dasblog_entryid":["95b8da55-983a-4485-ae88-89c0a375e3cb"],"dasblog_compressedtitle":["IronPython+And+LiveFX+Accessing+Profiles"],"dasblog_compressedtitleunique":["2008\/12\/13\/IronPython+And+LiveFX+Accessing+Profiles"]}},"previous_url":"http:\/\/devhawk.net\/2008\/12\/11\/ironpython-rtm-news-gets-around\/","next_url":"http:\/\/devhawk.net\/2008\/12\/16\/ironpython-and-livefx-oris-liveoe-py\/"}