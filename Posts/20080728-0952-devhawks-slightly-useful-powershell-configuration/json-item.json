{"status":"ok","post":{"id":1158,"type":"post","slug":"devhawks-slightly-useful-powershell-configuration","url":"http:\/\/devhawk.net\/2008\/07\/28\/devhawks-slightly-useful-powershell-configuration\/","status":"publish","title":"DevHawk&#8217;s Slightly Useful Powershell Configuration","title_plain":"DevHawk&#8217;s Slightly Useful Powershell Configuration","content":"<p>Since folks were interested in <a href=\"http:\/\/devhawk.net\/2008\/02\/28\/DevHawks+Inessential+List+Of+Tools.aspx\">my favorite tools<\/a>, I thought I&#8217;d blog how I have PowerShell configured. I&#8217;m not an ultra-power user, but I hold my own and hopefully you can use some of this configuration for yourself. Please tell me you&#8217;re not still using CMD. <\/p>\n<p>First, I use a trick I <a href=\"http:\/\/www.winterdom.com\/weblog\/2008\/01\/24\/ModifyingTheHomeInPowerShell.aspx\">picked up from Tomas Restrepo<\/a> to change your home directory and profile script. Here&#8217;s my Microsoft.PowerShell_profile.ps1 file (in the WindowsPowerShell subdirectory of My Documents) <\/p>\n<pre class=\"brush: powershell\">\n# reset $HOME and $PROFILE variables\nset-variable -name HOME -value \"D:HPierson.Files\" -force  \n(get-psprovider FileSystem).Home = $HOME  \nset-variable -name Profile -Value \"$HomeScripts_profile.ps1\"\n\n# Run the $PROFILE script\n. $profile\n<\/pre>\n<p>By default, PS uses the user&#8217;s personal directory (c:usershpierson in my case) as the home directory and the aforementioned filename for the profile script. Personally, I like to keep all &#8220;real&#8221; data off my boot partition so that I don&#8217;t have to back it all up when I repave. So my &#8220;real&#8221; home location is d:HPierson.Files. The above script sets both the $HOME variable and file system home property to this directory. It also resets the $PROFILE variable to a script in my $homeScripts folder and runs it.<\/p>\n<p>My $PROFILE script does several things of note:<\/p>\n<ul>\n<li>It adds the aforementioned $homeScripts folder to the path. My utilities folder is a permanent part of the path, put I only add the scripts folder when I&#8217;m actually running PS.  <\/li>\n<li>If I&#8217;m running as administrator, I set the background color of the console window to red. I think I picked up this script from <a href=\"http:\/\/bradwilson.typepad.com\/\">Brad Wilson<\/a> at some point.  <\/li>\n<li>Set location to home, otherwise when I start PS as admin, it starts in c:winsys32.  <\/li>\n<li>I have a simple prompt script file that displays current folder, the current command number and a list of yellow plus signs indicating how deep I am in the directory stack. To get it to work, I have to remove the standard prompt function, which I do in $PROFILE.  <\/li>\n<li>I can&#8217;t ever remember the space between &#8220;cd&#8221; and &#8220;..&#8221;, so I wrote a simple function called &#8220;cd..&#8221; that executes &#8220;cd ..&#8221;.  <\/li>\n<li>I have a su function that leverages the <a href=\"http:\/\/technet.microsoft.com\/en-us\/magazine\/cc162321.aspx\">Script Elevation PowerToys<\/a>. If you pass in a command, it executes it with elevated credentials. If you just execute su, it runs an elevated PowerShell.  <\/li>\n<li>I use <a href=\"http:\/\/www.7-zip.org\/\">7-zip<\/a> for my compression needs, including the 7za command line app. However, PS has issues w\/ executing an exe that starts with a number. So I aliased 7za as &#8220;zip&#8221;. <strong>UPDATE: <\/strong>Tomas <a href=\"http:\/\/twitter.com\/tomasrestrepo\/statuses\/870758014\">points out<\/a> that you can prepend an ampersand to force execution, so I could have typed &#8220;&amp;7za&#8221;. I forgot that when I created the alias and am now used to using zip, so I&#8217;m not going to change it. But I thought you should know. <\/li>\n<li>I have an ever-changing set of aliases, depending on my needs. Currently, I alias &#8220;ipy&#8221;, &#8220;cpy&#8221;, &#8220;fsi&#8221;, &#8220;fsc&#8221;, &#8220;devenv&#8221; and &#8220;chiron&#8221; to their fully path-qualified equivalents, so I can run them from anywhere without having to add their respective folders to the path.<\/li>\n<\/ul>\n<p>I don&#8217;t set vsvars in the $profile script, but I do have a copy of <a href=\"http:\/\/www.tavaresstudios.com\/Blog\/post\/The-last-vsvars32ps1-Ill-ever-need.aspx\">the one Chris Tavares wrote<\/a> in my scripts folder, so I can set up a VS environment in a moments&#8217; notice.<\/p>\n<p>Also, I put PowerShell on the Vista quick launch bar, so I can bring it up by typing Win-2.<\/p>\n","excerpt":"<p>Since folks were interested in my favorite tools, I thought I&#8217;d blog how I have PowerShell configured. I&#8217;m not an ultra-power user, but I hold my own and hopefully you can use some of this configuration for yourself. Please tell me you&#8217;re not still using CMD. First, I use a trick I picked up from [&hellip;]<\/p>\n","date":"2008-07-28 09:52:25","modified":"2008-07-28 09:52:25","categories":[],"tags":[{"id":230,"slug":"powershell","title":"PowerShell","description":"","post_count":41}],"author":{"id":1,"slug":"admin","name":"DevHawk","first_name":"Harry","last_name":"Pierson","nickname":"DevHawk","url":"","description":""},"comments":[{"id":2087,"name":"Philip Craig","url":"","date":"2008-07-28 10:23:03","content":"<p>Any chance of pasting the actual $profile for us to work on?<\/p>\n","parent":0},{"id":2088,"name":"Philip Craig","url":"","date":"2008-07-28 10:23:51","content":"<p>Would it be possible to post the actual $profile for us to see\/copy\/paste?<\/p>\n","parent":0},{"id":2089,"name":"orcmid","url":"http:\/\/orcmid.com\/BlunderDome\/clueless","date":"2008-07-28 12:20:16","content":"<p>yes, I am still using CMD!  (Simple reason for it, not important here.)<\/p>\n<p>But I have flagged this one as good things to do if and when I succumb to PowerShell.  Also, these are all good things to do in my various SFA and SUA shells too, as I get more into those subsystems.  (CMD and C Shell, I really am a throw-back!)<\/p>\n","parent":0},{"id":2090,"name":"Richard Rousseau","url":"http:\/\/www.richardrousseau.com","date":"2008-07-30 07:42:18","content":"<p>You should give the Powershell Community Extensions a look.  They have functions that cover the CD.. and CD&#8230; as well as zip functions and many more.<\/p>\n<p><a href=\"http:\/\/www.codeplex.com\/PowerShellCX\/Wiki\/View.aspx?title=PSCX%201.1.1%20Features&#038;referringTitle=Home\" rel=\"nofollow\">http:\/\/www.codeplex.com\/PowerShellCX\/Wiki\/View.aspx?title=PSCX%201.1.1%20Features&#038;referringTitle=Home<\/a><\/p>\n","parent":0},{"id":2091,"name":"DevHawk","url":"","date":"2008-07-30 11:29:48","content":"<p>@Richard, I keep meaning to take a look at the PS Community Extensions. Just haven&#8217;t made the time yet. Thanks for the heads up.<\/p>\n","parent":0}],"attachments":[],"comment_count":5,"comment_status":"closed","custom_fields":{"dasblog_entryid":["a64069d4-9084-46d2-b0c9-2cbf350b3d75"],"dasblog_compressedtitle":["DevHawks+Slightly+Useful+Powershell+Configuration"],"dasblog_compressedtitleunique":["2008\/07\/28\/DevHawks+Slightly+Useful+Powershell+Configuration"]}},"previous_url":"http:\/\/devhawk.net\/2008\/07\/25\/morning-coffee-171\/","next_url":"http:\/\/devhawk.net\/2008\/07\/28\/some-powershell-scripts\/"}