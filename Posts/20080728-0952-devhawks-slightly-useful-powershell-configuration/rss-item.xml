<?xml version="1.0" encoding="utf-8"?>
<item>
  <title>DevHawk's Slightly Useful Powershell Configuration</title>
  <link>http://devhawk.net/2008/07/28/devhawks-slightly-useful-powershell-configuration/</link>
  <pubDate>Mon, 28 Jul 2008 09:52:25 +0000</pubDate>
  <dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">devhawk</dc:creator>
  <guid isPermaLink="false">http://a64069d4-9084-46d2-b0c9-2cbf350b3d75</guid>
  <description></description>
  <content:encoded xmlns:content="http://purl.org/rss/1.0/modules/content/"><![CDATA[<p>Since folks were interested in <a href="http://devhawk.net/2008/02/28/DevHawks+Inessential+List+Of+Tools.aspx">my favorite tools</a>, I thought I'd blog how I have PowerShell configured. I'm not an ultra-power user, but I hold my own and hopefully you can use some of this configuration for yourself. Please tell me you're not still using CMD. </p><p>First, I use a trick I <a href="http://www.winterdom.com/weblog/2008/01/24/ModifyingTheHomeInPowerShell.aspx">picked up from Tomas Restrepo</a> to change your home directory and profile script. Here's my Microsoft.PowerShell_profile.ps1 file (in the WindowsPowerShell subdirectory of My Documents) </p><pre class="brush: powershell">
# reset $HOME and $PROFILE variables
set-variable -name HOME -value "D:HPierson.Files" -force  
(get-psprovider FileSystem).Home = $HOME  
set-variable -name Profile -Value "$HomeScripts_profile.ps1"

# Run the $PROFILE script
. $profile
</pre><p>By default, PS uses the user's personal directory (c:usershpierson in my case) as the home directory and the aforementioned filename for the profile script. Personally, I like to keep all "real" data off my boot partition so that I don't have to back it all up when I repave. So my "real" home location is d:HPierson.Files. The above script sets both the $HOME variable and file system home property to this directory. It also resets the $PROFILE variable to a script in my $homeScripts folder and runs it.</p><p>My $PROFILE script does several things of note:</p><ul><li>It adds the aforementioned $homeScripts folder to the path. My utilities folder is a permanent part of the path, put I only add the scripts folder when I'm actually running PS.  </li><li>If I'm running as administrator, I set the background color of the console window to red. I think I picked up this script from <a href="http://bradwilson.typepad.com/">Brad Wilson</a> at some point.  </li><li>Set location to home, otherwise when I start PS as admin, it starts in c:winsys32.  </li><li>I have a simple prompt script file that displays current folder, the current command number and a list of yellow plus signs indicating how deep I am in the directory stack. To get it to work, I have to remove the standard prompt function, which I do in $PROFILE.  </li><li>I can't ever remember the space between "cd" and "..", so I wrote a simple function called "cd.." that executes "cd ..".  </li><li>I have a su function that leverages the <a href="http://technet.microsoft.com/en-us/magazine/cc162321.aspx">Script Elevation PowerToys</a>. If you pass in a command, it executes it with elevated credentials. If you just execute su, it runs an elevated PowerShell.  </li><li>I use <a href="http://www.7-zip.org/">7-zip</a> for my compression needs, including the 7za command line app. However, PS has issues w/ executing an exe that starts with a number. So I aliased 7za as "zip". <strong>UPDATE: </strong>Tomas <a href="http://twitter.com/tomasrestrepo/statuses/870758014">points out</a> that you can prepend an ampersand to force execution, so I could have typed "&amp;7za". I forgot that when I created the alias and am now used to using zip, so I'm not going to change it. But I thought you should know. </li><li>I have an ever-changing set of aliases, depending on my needs. Currently, I alias "ipy", "cpy", "fsi", "fsc", "devenv" and "chiron" to their fully path-qualified equivalents, so I can run them from anywhere without having to add their respective folders to the path.</li></ul><p>I don't set vsvars in the $profile script, but I do have a copy of <a href="http://www.tavaresstudios.com/Blog/post/The-last-vsvars32ps1-Ill-ever-need.aspx">the one Chris Tavares wrote</a> in my scripts folder, so I can set up a VS environment in a moments' notice.</p><p>Also, I put PowerShell on the Vista quick launch bar, so I can bring it up by typing Win-2.</p>]]></content:encoded>
  <excerpt:encoded xmlns:excerpt="http://wordpress.org/export/1.2/excerpt/"><![CDATA[]]></excerpt:encoded>
  <wp:post_id xmlns:wp="http://wordpress.org/export/1.2/">1158</wp:post_id>
  <wp:post_date xmlns:wp="http://wordpress.org/export/1.2/">2008-07-28 09:52:25</wp:post_date>
  <wp:post_date_gmt xmlns:wp="http://wordpress.org/export/1.2/">2008-07-28 09:52:25</wp:post_date_gmt>
  <wp:comment_status xmlns:wp="http://wordpress.org/export/1.2/">open</wp:comment_status>
  <wp:ping_status xmlns:wp="http://wordpress.org/export/1.2/">open</wp:ping_status>
  <wp:post_name xmlns:wp="http://wordpress.org/export/1.2/">devhawks-slightly-useful-powershell-configuration</wp:post_name>
  <wp:status xmlns:wp="http://wordpress.org/export/1.2/">publish</wp:status>
  <wp:post_parent xmlns:wp="http://wordpress.org/export/1.2/">0</wp:post_parent>
  <wp:menu_order xmlns:wp="http://wordpress.org/export/1.2/">0</wp:menu_order>
  <wp:post_type xmlns:wp="http://wordpress.org/export/1.2/">post</wp:post_type>
  <wp:post_password xmlns:wp="http://wordpress.org/export/1.2/"></wp:post_password>
  <wp:is_sticky xmlns:wp="http://wordpress.org/export/1.2/">0</wp:is_sticky>
  <category domain="post_tag" nicename="powershell"><![CDATA[PowerShell]]></category>
  <category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_entryid</wp:meta_key>
    <wp:meta_value><![CDATA[a64069d4-9084-46d2-b0c9-2cbf350b3d75]]></wp:meta_value>
  </wp:postmeta>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_compressedtitle</wp:meta_key>
    <wp:meta_value><![CDATA[DevHawks+Slightly+Useful+Powershell+Configuration]]></wp:meta_value>
  </wp:postmeta>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_compressedtitleunique</wp:meta_key>
    <wp:meta_value><![CDATA[2008/07/28/DevHawks+Slightly+Useful+Powershell+Configuration]]></wp:meta_value>
  </wp:postmeta>
  <wp:comment xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:comment_id>2087</wp:comment_id>
    <wp:comment_author><![CDATA[Philip Craig]]></wp:comment_author>
    <wp:comment_author_email>philip@pobox.com</wp:comment_author_email>
    <wp:comment_author_url></wp:comment_author_url>
    <wp:comment_author_IP>147.62.42.119</wp:comment_author_IP>
    <wp:comment_date>2008-07-28 10:23:03</wp:comment_date>
    <wp:comment_date_gmt>2008-07-28 17:23:03</wp:comment_date_gmt>
    <wp:comment_content><![CDATA[Any chance of pasting the actual $profile for us to work on?]]></wp:comment_content>
    <wp:comment_approved>1</wp:comment_approved>
    <wp:comment_type></wp:comment_type>
    <wp:comment_parent>0</wp:comment_parent>
    <wp:comment_user_id>0</wp:comment_user_id>
  </wp:comment>
  <wp:comment xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:comment_id>2088</wp:comment_id>
    <wp:comment_author><![CDATA[Philip Craig]]></wp:comment_author>
    <wp:comment_author_email>philip@pobox.com</wp:comment_author_email>
    <wp:comment_author_url></wp:comment_author_url>
    <wp:comment_author_IP>147.62.42.119</wp:comment_author_IP>
    <wp:comment_date>2008-07-28 10:23:51</wp:comment_date>
    <wp:comment_date_gmt>2008-07-28 17:23:51</wp:comment_date_gmt>
    <wp:comment_content><![CDATA[Would it be possible to post the actual $profile for us to see/copy/paste?]]></wp:comment_content>
    <wp:comment_approved>1</wp:comment_approved>
    <wp:comment_type></wp:comment_type>
    <wp:comment_parent>0</wp:comment_parent>
    <wp:comment_user_id>0</wp:comment_user_id>
  </wp:comment>
  <wp:comment xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:comment_id>2089</wp:comment_id>
    <wp:comment_author><![CDATA[orcmid]]></wp:comment_author>
    <wp:comment_author_email>dennis.hamilton@acm.org</wp:comment_author_email>
    <wp:comment_author_url>http://orcmid.com/BlunderDome/clueless</wp:comment_author_url>
    <wp:comment_author_IP>71.35.110.8</wp:comment_author_IP>
    <wp:comment_date>2008-07-28 12:20:16</wp:comment_date>
    <wp:comment_date_gmt>2008-07-28 19:20:16</wp:comment_date_gmt>
    <wp:comment_content><![CDATA[yes, I am still using CMD!  (Simple reason for it, not important here.)

But I have flagged this one as good things to do if and when I succumb to PowerShell.  Also, these are all good things to do in my various SFA and SUA shells too, as I get more into those subsystems.  (CMD and C Shell, I really am a throw-back!)]]></wp:comment_content>
    <wp:comment_approved>1</wp:comment_approved>
    <wp:comment_type></wp:comment_type>
    <wp:comment_parent>0</wp:comment_parent>
    <wp:comment_user_id>0</wp:comment_user_id>
  </wp:comment>
  <wp:comment xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:comment_id>2090</wp:comment_id>
    <wp:comment_author><![CDATA[Richard Rousseau]]></wp:comment_author>
    <wp:comment_author_email></wp:comment_author_email>
    <wp:comment_author_url>http://www.richardrousseau.com</wp:comment_author_url>
    <wp:comment_author_IP>67.152.152.11</wp:comment_author_IP>
    <wp:comment_date>2008-07-30 07:42:18</wp:comment_date>
    <wp:comment_date_gmt>2008-07-30 14:42:18</wp:comment_date_gmt>
    <wp:comment_content><![CDATA[You should give the Powershell Community Extensions a look.  They have functions that cover the CD.. and CD... as well as zip functions and many more.

http://www.codeplex.com/PowerShellCX/Wiki/View.aspx?title=PSCX%201.1.1%20Features&referringTitle=Home]]></wp:comment_content>
    <wp:comment_approved>1</wp:comment_approved>
    <wp:comment_type></wp:comment_type>
    <wp:comment_parent>0</wp:comment_parent>
    <wp:comment_user_id>0</wp:comment_user_id>
  </wp:comment>
  <wp:comment xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:comment_id>2091</wp:comment_id>
    <wp:comment_author><![CDATA[DevHawk]]></wp:comment_author>
    <wp:comment_author_email>harry@devhawk.net</wp:comment_author_email>
    <wp:comment_author_url></wp:comment_author_url>
    <wp:comment_author_IP>131.107.0.102</wp:comment_author_IP>
    <wp:comment_date>2008-07-30 11:29:48</wp:comment_date>
    <wp:comment_date_gmt>2008-07-30 18:29:48</wp:comment_date_gmt>
    <wp:comment_content><![CDATA[@Richard, I keep meaning to take a look at the PS Community Extensions. Just haven't made the time yet. Thanks for the heads up.]]></wp:comment_content>
    <wp:comment_approved>1</wp:comment_approved>
    <wp:comment_type></wp:comment_type>
    <wp:comment_parent>0</wp:comment_parent>
    <wp:comment_user_id>0</wp:comment_user_id>
  </wp:comment>
</item>