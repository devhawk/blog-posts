<?xml version="1.0" encoding="utf-8"?>
<item>
  <title>IronPython ConsoleColorMgr</title>
  <link>http://devhawk.net/2009/03/19/ironpython-consolecolormgr/</link>
  <pubDate>Thu, 19 Mar 2009 16:43:51 +0000</pubDate>
  <dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">devhawk</dc:creator>
  <guid isPermaLink="false">http://30e6352e-6825-4364-905c-aac5b56964e3</guid>
  <description></description>
  <content:encoded xmlns:content="http://purl.org/rss/1.0/modules/content/"><![CDATA[<p>I really liked the ConsoleColorMgr class from my <a href="http://devhawk.net/2009/03/19/Writing+An+IronPython+Debugger+Colorful+Console.aspx">last ipydbg post</a> so I took a few minutes to yank it out into its own seperate module. I also took the opportunity to make a few improvements.</p><p>First off, I added support for background colors as well as foreground colors. Furthermore, both colors default to “None” which ConsoleColorMgr takes to mean leave that color unchanged. </p><pre class="brush: python">
from System import Console as _Console     

class ConsoleColorMgr(object):     
  def __init__(self, foreground = None, background = None):     
    self.foreground = foreground     
    self.background = background     

  def __enter__(self):   
    self._tempFG = _Console.ForegroundColor   
    self._tempBG = _Console.BackgroundColor  
    if self.foreground: _Console.ForegroundColor = self.foreground   
    if self.background: _Console.BackgroundColor = self.background     
       
  def __exit__(self, t, v, tr):   
    _Console.ForegroundColor = self._tempFG  
    _Console.BackgroundColor = self._tempBG
</pre><p>The other change I made was to build a set of default ConsoleColorMgr instances in the consolecolor module, one for each of the values in <a href="http://msdn.microsoft.com/en-us/library/system.consolecolor.aspx">ConsoleColor</a>. </p><pre class="brush: python">
import sys   
from System import ConsoleColor, Enum     
   
_curmodule = sys.modules[__name__]     

for n in Enum.GetNames(ConsoleColor):     
    setattr(_curmodule, n, ConsoleColorMgr(Enum.Parse(ConsoleColor, n)))
</pre><p>Note that for this set of default ConsoleColorMgr instances, I’m only setting the foreground color. If you want to set the background color, you have to create your own ConsoleColorMgr instances. This allows me to write the following:</p><pre class="brush: python">
from __future__ import with_statement     
import consolecolor    

with consolecolor.Red:     
    print "Open the pod bay doors, HAL"    
with consolecolor.ConsoleColorMgr(ConsoleColor.Black, ConsoleColor.Red):  
    print "I'm sorry Dave, I'm afraid I can't do that."
</pre><p>If you want it, I’ve put consolecolor.py up <a href="http://cid-0d9bc809858885a4.skydrive.live.com/self.aspx/DevHawk%20Content/IronPython%20Stuff/consolecolor.py">on my skydrive</a> or it’s available as part of my <a href="http://github.com/devhawk/devhawk_ipy/tree/master">devhawk_ipy project</a> on GitHub. </p><p><strong>Update</strong> - <a href="http://bermingham.blogspot.com">Christopher Bermingham</a> pointed out that my sample snippet at the end doesn’t work unless you add “from <a href="http://docs.python.org/library/__future__.html">__future__</a> import with_statement” to the top of your python file. I updated my code snippet to include this. Thanks Christopher!</p>]]></content:encoded>
  <excerpt:encoded xmlns:excerpt="http://wordpress.org/export/1.2/excerpt/"><![CDATA[]]></excerpt:encoded>
  <wp:post_id xmlns:wp="http://wordpress.org/export/1.2/">1231</wp:post_id>
  <wp:post_date xmlns:wp="http://wordpress.org/export/1.2/">2009-03-19 16:43:51</wp:post_date>
  <wp:post_date_gmt xmlns:wp="http://wordpress.org/export/1.2/">2009-03-19 16:43:51</wp:post_date_gmt>
  <wp:comment_status xmlns:wp="http://wordpress.org/export/1.2/">open</wp:comment_status>
  <wp:ping_status xmlns:wp="http://wordpress.org/export/1.2/">open</wp:ping_status>
  <wp:post_name xmlns:wp="http://wordpress.org/export/1.2/">ironpython-consolecolormgr</wp:post_name>
  <wp:status xmlns:wp="http://wordpress.org/export/1.2/">publish</wp:status>
  <wp:post_parent xmlns:wp="http://wordpress.org/export/1.2/">0</wp:post_parent>
  <wp:menu_order xmlns:wp="http://wordpress.org/export/1.2/">0</wp:menu_order>
  <wp:post_type xmlns:wp="http://wordpress.org/export/1.2/">post</wp:post_type>
  <wp:post_password xmlns:wp="http://wordpress.org/export/1.2/"></wp:post_password>
  <wp:is_sticky xmlns:wp="http://wordpress.org/export/1.2/">0</wp:is_sticky>
  <category domain="category" nicename="ironpython"><![CDATA[IronPython]]></category>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_entryid</wp:meta_key>
    <wp:meta_value><![CDATA[30e6352e-6825-4364-905c-aac5b56964e3]]></wp:meta_value>
  </wp:postmeta>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_compressedtitle</wp:meta_key>
    <wp:meta_value><![CDATA[IronPython+ConsoleColorMgr]]></wp:meta_value>
  </wp:postmeta>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_compressedtitleunique</wp:meta_key>
    <wp:meta_value><![CDATA[2009/03/19/IronPython+ConsoleColorMgr]]></wp:meta_value>
  </wp:postmeta>
  <wp:comment xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:comment_id>2181</wp:comment_id>
    <wp:comment_author><![CDATA[Christopher Bermingham]]></wp:comment_author>
    <wp:comment_author_email>christopher.bermingham@us.bosch.com</wp:comment_author_email>
    <wp:comment_author_url>http://bermingham.blogspot.com</wp:comment_author_url>
    <wp:comment_author_IP>209.221.240.193</wp:comment_author_IP>
    <wp:comment_date>2009-03-20 09:07:08</wp:comment_date>
    <wp:comment_date_gmt>2009-03-20 16:07:08</wp:comment_date_gmt>
    <wp:comment_content><![CDATA[Hello-  I am trying to get your consolecolor sample running...  What version of IronPython is that?  I am running the latest release 2.0.0.0 (which is really 2.0.1 file version 2.0.20209.00).  I believe the CPython 2.5 'with' statement doesn't seem to be recognized.

>>> with consolecolor.Red:
  File "<stdin>", line 1
    with consolecolor.Red

         ^
SyntaxError: unexpected token 'consolecolor']]></wp:comment_content>
    <wp:comment_approved>1</wp:comment_approved>
    <wp:comment_type></wp:comment_type>
    <wp:comment_parent>0</wp:comment_parent>
    <wp:comment_user_id>0</wp:comment_user_id>
  </wp:comment>
  <wp:comment xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:comment_id>2182</wp:comment_id>
    <wp:comment_author><![CDATA[Christopher Bermingham]]></wp:comment_author>
    <wp:comment_author_email>christopher.bermingham@us.bosch.com</wp:comment_author_email>
    <wp:comment_author_url>http://bermingham.blogspot.com</wp:comment_author_url>
    <wp:comment_author_IP>209.221.240.193</wp:comment_author_IP>
    <wp:comment_date>2009-03-20 12:26:33</wp:comment_date>
    <wp:comment_date_gmt>2009-03-20 19:26:33</wp:comment_date_gmt>
    <wp:comment_content><![CDATA[Me again-
I found it in an article that it looks like you have bookmarked :)
from __future__ import with_statement

http://langexplr.blogspot.com/2009/02/writing-xml-with-ironpython-xmlwriter.html

Your sample looks great.  Thanks!]]></wp:comment_content>
    <wp:comment_approved>1</wp:comment_approved>
    <wp:comment_type></wp:comment_type>
    <wp:comment_parent>0</wp:comment_parent>
    <wp:comment_user_id>0</wp:comment_user_id>
  </wp:comment>
  <wp:comment xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:comment_id>2183</wp:comment_id>
    <wp:comment_author><![CDATA[DevHawk]]></wp:comment_author>
    <wp:comment_author_email>harry@devhawk.net</wp:comment_author_email>
    <wp:comment_author_url></wp:comment_author_url>
    <wp:comment_author_IP>131.107.0.80</wp:comment_author_IP>
    <wp:comment_date>2009-03-20 13:45:26</wp:comment_date>
    <wp:comment_date_gmt>2009-03-20 20:45:26</wp:comment_date_gmt>
    <wp:comment_content><![CDATA[Woops, thanks for pointing out my mistake Christoper. I've updated the code to include the __future__ import.

As for that xmlwriter article, that was the inspiration for this approach!]]></wp:comment_content>
    <wp:comment_approved>1</wp:comment_approved>
    <wp:comment_type></wp:comment_type>
    <wp:comment_parent>0</wp:comment_parent>
    <wp:comment_user_id>0</wp:comment_user_id>
  </wp:comment>
</item>