<?xml version="1.0" encoding="utf-8"?>
<item>
  <title>WSS Web Services</title>
  <link>http://devhawk.net/2003/09/09/wss-web-services/</link>
  <pubDate>Tue, 09 Sep 2003 21:49:59 +0000</pubDate>
  <dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">devhawk</dc:creator>
  <guid isPermaLink="false">http://a88df139-a010-4113-9bab-4b63dab01506</guid>
  <description></description>
  <content:encoded xmlns:content="http://purl.org/rss/1.0/modules/content/"><![CDATA[<p>Not much blogging of late. Trend likely to continue. Details at 11.</p><p>However, I did make an interesting discovery about <a href="http://www.microsoft.com/windowsserver2003/technologies/sharepoint/default.mspx"> Windows SharePoint Services</a> I wanted to share. Obviously, I've been thinking WSS in terms of blogging (hence the <a href="prj_sharepointsynd.aspx"> project</a> to expose RSS from WSS). However, I've been frustrated by what should be a simple little thing. WSS includes a rich text editor that enables me to write content that's bold, italics, colored, fonted, sized, indented, bulleted, etc. However, until today, I couldn't figure out how to do hyperlinks. WSS will automagically render a url as a hyperlink. But there was no way to build an anchor tag hyperlink, so your forced to embed urls directly in the text. I didn't like that, so I set about trying to fix it. Turns out to not be a big deal.</p><p>It turns out that the <a href="http://msdn.microsoft.com/library/en-us/spptsdk/html/tscSPFieldMultiLineText.asp"> SPFieldMultiLine</a> class supports a property named <a href="http://msdn.microsoft.com/library/en-us/spptsdk/html/tspSPFieldMultiLineTextAllowHyperlink.asp"> AllowHyperlinks</a>. If you can flip this bit, the rich text editor in WSS will suddenly get a Hyperlink button and enable the creation of anchor tag hyperlinks. Unfortunately, there doesn't appear to be any way to flip this bit via the existing UI as of B2TR (no, even though I work at MSFT, I don't have the RTM bits yet). So I built a web app (as per <a href="http://msdn.microsoft.com/library/en-us/spptsdk/html/tsovVSNETIntro.asp"> these instructions</a>) that programmatically flipped that bit via the WSS object model. I also could have done it via a console or windows form app, again via the WSS object model. However, that object model only works on the WSS machine itself - there's no concept of remoting via the OM. But WSS does expose much of its functionality remotely via web services, including a <a href="http://msdn.microsoft.com/library/en-us/spptsdk/html/soapcLists.asp"> List web service</a>.</p><p>The WSS Web Service interface (WSI?) is a little funky, but I munged up a little utility to flip the AllowHyperlinks property programmatically. The inputs and outputs of the service are XML (actually an XML grammar called <a href="http://msdn.microsoft.com/library/en-us/spptsdk/html/SPPTWSSCAML.asp"> CAML</a>) so the inputs and outputs of the service proxy are XmlNodes. The DOM is an ugly way to build XML documents, so I used Chris Lovett's <a href="http://gotdotnet.com/Community/UserSamples/Details.aspx?SampleGuid=8F9DE8A7-FEC9-48E1-91C5-1FC569CDE11C"> XmlNodeWriter</a> utility class to get an XmlWriter interface on my XmlDocument. Other than that, the code was pretty straight forward. In pseudo-code, it looks like:</p><ol><li>Call ListServiceProxy.<a href="http://msdn.microsoft.com/library/en-us/spptsdk/html/soapmListsGetList.asp">GetList</a>(listName) to get the definition of the list in CAML</li><li>Use XPath to find the element that represents the field I want to change (//sp:Field[@DisplayName='fieldName'])</li><li>Create a new XmlDocument that contains a single method block for the field I want to change (see docs for <a href="http://msdn.microsoft.com/library/en-us/spptsdk/html/soapmListsUpdateList.asp"> UpdateList</a> for explanation). Write the CAML representation of the field into the method block. This CAML is identical to the CAML from the previous step, except that I've added AllowHyperlinks="TRUE'</li><li>Call ListServiceProxy.UpdateList, passing in the the constructed XmlDocument as the updateFields parameter.</li><li>UpdateList returns an XmlNode that contains the result of the update. XPath query via method block ID to determine if the update succeeded or failed.</li></ol><p>I will post the code after I clean it up a bit. However, I don't know when that will be.</p>]]></content:encoded>
  <excerpt:encoded xmlns:excerpt="http://wordpress.org/export/1.2/excerpt/"><![CDATA[]]></excerpt:encoded>
  <wp:post_id xmlns:wp="http://wordpress.org/export/1.2/">189</wp:post_id>
  <wp:post_date xmlns:wp="http://wordpress.org/export/1.2/">2003-09-09 21:49:59</wp:post_date>
  <wp:post_date_gmt xmlns:wp="http://wordpress.org/export/1.2/">2003-09-09 21:49:59</wp:post_date_gmt>
  <wp:comment_status xmlns:wp="http://wordpress.org/export/1.2/">open</wp:comment_status>
  <wp:ping_status xmlns:wp="http://wordpress.org/export/1.2/">open</wp:ping_status>
  <wp:post_name xmlns:wp="http://wordpress.org/export/1.2/">wss-web-services</wp:post_name>
  <wp:status xmlns:wp="http://wordpress.org/export/1.2/">publish</wp:status>
  <wp:post_parent xmlns:wp="http://wordpress.org/export/1.2/">0</wp:post_parent>
  <wp:menu_order xmlns:wp="http://wordpress.org/export/1.2/">0</wp:menu_order>
  <wp:post_type xmlns:wp="http://wordpress.org/export/1.2/">post</wp:post_type>
  <wp:post_password xmlns:wp="http://wordpress.org/export/1.2/"></wp:post_password>
  <wp:is_sticky xmlns:wp="http://wordpress.org/export/1.2/">0</wp:is_sticky>
  <category domain="category" nicename="uncategorized"><![CDATA[Uncategorized]]></category>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_entryid</wp:meta_key>
    <wp:meta_value><![CDATA[a88df139-a010-4113-9bab-4b63dab01506]]></wp:meta_value>
  </wp:postmeta>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_compressedtitle</wp:meta_key>
    <wp:meta_value><![CDATA[WSS+Web+Services]]></wp:meta_value>
  </wp:postmeta>
  <wp:postmeta xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:meta_key>dasblog_compressedtitleunique</wp:meta_key>
    <wp:meta_value><![CDATA[2003/09/10/WSS+Web+Services]]></wp:meta_value>
  </wp:postmeta>
  <wp:comment xmlns:wp="http://wordpress.org/export/1.2/">
    <wp:comment_id>2919</wp:comment_id>
    <wp:comment_author><![CDATA[Daniel]]></wp:comment_author>
    <wp:comment_author_email>danielf@resolutecorp.com</wp:comment_author_email>
    <wp:comment_author_url>http://www.resolutecorp.com</wp:comment_author_url>
    <wp:comment_author_IP>66.239.39.82</wp:comment_author_IP>
    <wp:comment_date>2005-09-12 08:17:31</wp:comment_date>
    <wp:comment_date_gmt>2005-09-12 15:17:31</wp:comment_date_gmt>
    <wp:comment_content><![CDATA[I'm having trouble getting the UpdateList Web Service to work correctly. Can I take a peek at your code? Thanks.]]></wp:comment_content>
    <wp:comment_approved>1</wp:comment_approved>
    <wp:comment_type></wp:comment_type>
    <wp:comment_parent>0</wp:comment_parent>
    <wp:comment_user_id>0</wp:comment_user_id>
  </wp:comment>
</item>