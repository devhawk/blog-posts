{"status":"ok","post":{"id":1207,"type":"post","slug":"powershell-find-to-set-alias","url":"http:\/\/devhawk.net\/2008\/12\/17\/powershell-find-to-set-alias\/","status":"publish","title":"PowerShell find-to-set-alias","title_plain":"PowerShell find-to-set-alias","content":"<p>I use Live Mesh to keep my PowerShell scripts folder synced between multiple machine. Some of those machines have different things installed on them or have things installed in different locations. For example, my laptop is x86 while my desktop is x64 so many things on the desktop get installed into c:\\Program Files (x86) instead of the plain-old c:\\Program Files folder. I wanted my shared profile script to be able to search a set of folders for a given executable to alias, and I came up with the following function.<\/p>\n<pre class=\"brush: powershell\">function find-to-set-alias($foldersearch, $file, $alias)\r\n{\r\n  dir $foldersearch |\r\n    %{dir $_ -Recurse -Filter $file} |\r\n    %{set-alias $alias $_.FullName -scope Global; break}\r\n}<\/pre>\n<p>It\u2019s pretty simple to use. You pass in a folder search criteria \u2013 it must have a wildcard, or the function won\u2019t work \u2013 the file you\u2019re looking for and the alias you want to set. The function finds all the folders matching the $foldersearch criteria, then searches them recursively looking for the $file you specified. Set-alias is called for the first matching $file found \u2013 pipeline processing is halted via the break statement.<\/p>\n<p>Here are the find-to-set-aliases I have in my profile:<\/p>\n<pre class=\"brush: powershell\">find-to-set-alias 'c:\\program files*\\IronPython*' ipy.exe ipy\r\nfind-to-set-alias 'c:\\program files*\\IronPython*' chiron.exe chiron     \r\n\r\nfind-to-set-alias 'c:\\Python*' python.exe cpy     \r\n\r\nfind-to-set-alias\r\n    'c:program files*\\Microsoft Visual Studio 9.0\\Common7' devenv.exe vs\r\nfind-to-set-alias\r\n    'c:program files*\\Microsoft Visual Studio 9.0\\Common7' tf.exe tf     \r\n\r\nfind-to-set-alias 'c:\\program files*\\FSharp*' fsi.exe fsi\r\nfind-to-set-alias\r\n    'c:\\program files*\\Microsoft Repository SDK*' ipad.exe ipad\r\nfind-to-set-alias\r\n    'c:\\program files*\\Microsoft Virtual PC*' 'Virtual pc.exe' vpc<\/pre>\n<p>Python, IronPython and F# aliases, no surprise there. Chiron is the REPL server for dynamic language Silverlight development. Typically, I use <a href=\"http:\/\/www.tavaresstudios.com\/Blog\/post\/The-last-vsvars32ps1-Ill-ever-need.aspx\">Chris Tavares\u2019 vsvars script<\/a> to configure the command shell for development purposes, but I find it\u2019s nice to have aliases for TF and DevEnv handy at all times.<\/p>\n","excerpt":"<p>I use Live Mesh to keep my PowerShell scripts folder synced between multiple machine. Some of those machines have different things installed on them or have things installed in different locations. For example, my laptop is x86 while my desktop is x64 so many things on the desktop get installed into c:\\Program Files (x86) instead [&hellip;]<\/p>\n","date":"2008-12-17 15:17:09","modified":"2011-04-17 20:50:37","categories":[{"id":223,"slug":"general-geekery","title":"General Geekery","description":"","parent":0,"post_count":35}],"tags":[{"id":230,"slug":"powershell","title":"PowerShell","description":"","post_count":41}],"author":{"id":1,"slug":"admin","name":"DevHawk","first_name":"Harry","last_name":"Pierson","nickname":"DevHawk","url":"","description":""},"comments":[{"id":2161,"name":"Dave","url":"http:\/\/famoushamsandwich.blogspot.com","date":"2008-12-17 16:34:55","content":"<p>I do the same thing and solved it using ${env:programfiles}.<\/p>\n","parent":0},{"id":2162,"name":"Brad Wilson","url":"http:\/\/bradwilson.typepad.com\/","date":"2008-12-28 12:47:47","content":"<p>Thanks for this! I posted an expanded version suitable for use as a script file, which includes optional diagnostic\/debugging information:<\/p>\n<p><a href=\"http:\/\/bradwilson.typepad.com\/blog\/2008\/12\/find-to-set-aliasps1.html\" rel=\"nofollow\">http:\/\/bradwilson.typepad.com\/blog\/2008\/12\/find-to-set-aliasps1.html<\/a><\/p>\n","parent":0}],"attachments":[],"comment_count":2,"comment_status":"closed","custom_fields":{"dasblog_entryid":["ae593a6d-e9b4-40ad-9a2e-fe46accd5f78"],"dasblog_compressedtitle":["PowerShell+Findtosetalias"],"dasblog_compressedtitleunique":["2008\/12\/17\/PowerShell+Findtosetalias"]}},"previous_url":"http:\/\/devhawk.net\/2008\/12\/16\/ironpython-and-livefx-raw-http-access\/","next_url":"http:\/\/devhawk.net\/2008\/12\/18\/the-reeses-peanut-butter-cups-of-language-conferences\/"}