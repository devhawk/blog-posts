{"status":"ok","post":{"id":1128,"type":"post","slug":"webdev-webserver-powershell-function","url":"http:\/\/devhawk.net\/2008\/03\/20\/webdev-webserver-powershell-function\/","status":"publish","title":"WebDev.WebServer PowerShell Function","title_plain":"WebDev.WebServer PowerShell Function","content":"<p>In experimenting with <a href=\"http:\/\/www.codeplex.com\/NWSGI\">NWSGI<\/a> yesterday, I found I wanted the ability to launch the development web server that ships with Visual Studio (WebDev.WebServer.exe) from the command line. I hacked up the following PowerShell function and dropped it into my $profile so I can easily launch the web server in any directory any time I need. Thought I&#8217;d share:<\/p>\n<pre class=\"brush: powershell\">function webdev($path,$port=8080,$vpath='\/')   \r\n{   \r\n    $spath = 'C:\\Program Files\\Common Files\\microsoft shared\\DevServer9.0\\WebDev.WebServer.EXE'\r\n    $rpath = resolve-path $path  \r\n    $params = \"\/path:`\"$rpath`\" \/port:$port \/vpath:$vpath\"  \r\n\r\n    $ignore = [System.Diagnostics.Process]::Start($spath, $params)  \r\n    \"Started WebDev Server for '$path' directory on port $port\"  \r\n}<\/pre>\n<p>There&#8217;s probably an easier way to launch an exe with parameters than Sys.Diags.Process.Start, but it works. Using resolve-path is the key, that lets me pass in a relative path on the command line, but the script converts it to an absolute path in order to pass it to the webdev server. Also, I&#8217;m not sure I should have hard coded the path to the exe, but again it works and it&#8217;s not like it&#8217;s tough to change.<\/p>\n<p>Enjoy.<\/p>\n<p><strong><span style=\"text-decoration: underline;\">Update<\/span><\/strong>: Tomas Restrepo pointed out an easier way to start the process:<\/p>\n<pre class=\"brush: powershell\">&amp;'C:\\Program Files\\Common Files\\microsoft shared\\DevServer9.0\\WebDev.WebServer.EXE' \"\/path:$rpath\" \"\/port:$port\" \"\/vpath:$vpath\"<\/pre>\n<p>I couldn&#8217;t figure out how to correctly launch the exe when the physical path to serve has a space in it. Thanks Tomas.<\/p>\n","excerpt":"<p>In experimenting with NWSGI yesterday, I found I wanted the ability to launch the development web server that ships with Visual Studio (WebDev.WebServer.exe) from the command line. I hacked up the following PowerShell function and dropped it into my $profile so I can easily launch the web server in any directory any time I need. [&hellip;]<\/p>\n","date":"2008-03-20 15:39:00","modified":"2011-04-17 00:53:35","categories":[{"id":204,"slug":"development","title":"Development","description":"","parent":0,"post_count":165}],"tags":[{"id":178,"slug":"asp-net","title":"ASP.NET","description":"","post_count":27},{"id":230,"slug":"powershell","title":"PowerShell","description":"","post_count":41}],"author":{"id":1,"slug":"admin","name":"DevHawk","first_name":"Harry","last_name":"Pierson","nickname":"DevHawk","url":"","description":""},"comments":[{"id":2049,"name":"Tomas Restrepo","url":"http:\/\/www.winterdom.com\/weblog\/","date":"2008-03-20 18:01:40","content":"<p>Pretty cool Harry. There&#8217;s actually an easier way of running it, something like this would work just fine:<\/p>\n<p>&#038;&#8217;C:Program FilesCommon Filesmicrosoft sharedDevServer9.0WebDev.WebServer.EXE&#8217; &#8220;\/path:$rpath&#8221; &#8220;\/port:$port&#8221; &#8220;\/vpath:$vpath&#8221;<\/p>\n","parent":0},{"id":2050,"name":"C-J Berg","url":"","date":"2008-03-21 15:28:02","content":"<p>I wrote a similar function some time ago. It&#8217;s a bit longer, but it works on x64, and on machines with only .NET FW 2.0 installed:<\/p>\n<p># Start-WebDevServer<br \/>\nfunction TryLocateWebDevServer($EnvVar, $SubPath) {<br \/>\n\t$e = &#8216;env:&#8217; + $EnvVar<br \/>\n\tif (Test-Path $e) {<br \/>\n\t\t$wdpath = Join-Path (Get-Content $e) (Join-Path $SubPath &#8216;WebDev.WebServer.EXE&#8217;)<br \/>\n\t\tif (Test-Path $wdpath) {<br \/>\n\t\t\treturn $wdpath<br \/>\n\t\t}<br \/>\n\t}<br \/>\n\treturn $FALSE<br \/>\n}<br \/>\nfunction Start-WebDevServer($Path, $Port=8080, $VPath=&#8217;\/')<br \/>\n{<br \/>\n\tif (-not $Path -or -not (Test-Path $Path)) {<br \/>\n\t\tThrow &#8220;Invalid Path specified!&#8221;<br \/>\n\t}<\/p>\n<p>\t$locations =<br \/>\n\t\t(&#8216;CommonProgramFiles(x86)&#8217;, &#8216;Microsoft SharedDevServer9.0&#8242;),<br \/>\n\t\t(&#8216;CommonProgramFiles&#8217;, &#8216;Microsoft SharedDevServer9.0&#8242;),<br \/>\n\t\t(&#8216;SystemRoot&#8217;, &#8216;Microsoft.NETFrameworkv2.0.50727&#8242;)<\/p>\n<p>\tforeach ($l in $locations) {<br \/>\n\t\t$wdpath = TryLocateWebDevServer $l[0] $l[1]<br \/>\n\t\tif ($wdpath) {<br \/>\n\t\t\tbreak;<br \/>\n\t\t}<br \/>\n\t}<br \/>\n\tif (-not $wdpath) {<br \/>\n\t\tThrow &#8216;Cannot locate WebDev.WebServer.EXE!&#8217;<br \/>\n\t}<\/p>\n<p>\t$rpath = Resolve-Path $Path<\/p>\n<p>\tWrite-Host &#8220;Starting WebDev.WebServer located at:&#8221;<br \/>\n\tWrite-Host &#8221; $wdpath&#8221;<br \/>\n\tWrite-Host &#8221; Parameters: &#8220;&#8221;\/path:$rpath&#8221;\" &#8220;&#8221;\/port:$Port&#8221;\" &#8220;&#8221;\/vpath:$VPath&#8221;\"&#8221;<\/p>\n<p>\t&#038; $wdpath &#8220;\/path:$rpath&#8221; &#8220;\/port:$Port&#8221; &#8220;\/vpath:$VPath&#8221;<br \/>\n}<br \/>\nSet-Alias webdev Start-WebDevServer<\/p>\n<p>Cheers!<\/p>\n","parent":0},{"id":2051,"name":"DevHawk","url":"","date":"2008-03-24 11:19:05","content":"<p>@C-J, I really like how you added the function to find the exe rather than hard coding it.<\/p>\n","parent":0},{"id":2052,"name":"Richard","url":"","date":"2008-03-26 07:57:11","content":"<p>> $ignore = [System.Diagnostics.Process]::Start(&#8230;)<\/p>\n<p>There are three canonical PSH ways to ignore the result of an expression:<br \/>\n- Assign to $null<br \/>\n- Redirect to $null (&#8230;. > $null)<br \/>\n- Cast to [void]<\/p>\n","parent":0}],"attachments":[],"comment_count":4,"comment_status":"closed","custom_fields":{"dasblog_entryid":["631d2f09-cb8f-4e40-bad0-dfecce979257"],"dasblog_compressedtitle":["WebDevWebServer+PowerShell+Function"],"dasblog_compressedtitleunique":["2008\/03\/20\/WebDevWebServer+PowerShell+Function"]}},"previous_url":"http:\/\/devhawk.net\/2008\/03\/20\/morning-coffee-159\/","next_url":"http:\/\/devhawk.net\/2008\/03\/21\/will-the-real-devhawk-please-stand-up\/"}