<?xml version="1.0" encoding="utf-8"?>
<wp:comment xmlns:wp="http://wordpress.org/export/1.2/">
  <wp:comment_id>2050</wp:comment_id>
  <wp:comment_author><![CDATA[C-J Berg]]></wp:comment_author>
  <wp:comment_author_email></wp:comment_author_email>
  <wp:comment_author_url></wp:comment_author_url>
  <wp:comment_author_IP>87.227.2.165</wp:comment_author_IP>
  <wp:comment_date>2008-03-21 15:28:02</wp:comment_date>
  <wp:comment_date_gmt>2008-03-21 22:28:02</wp:comment_date_gmt>
  <wp:comment_content><![CDATA[I wrote a similar function some time ago. It's a bit longer, but it works on x64, and on machines with only .NET FW 2.0 installed:


# Start-WebDevServer
function TryLocateWebDevServer($EnvVar, $SubPath) {
	$e = 'env:' + $EnvVar
	if (Test-Path $e) {
		$wdpath = Join-Path (Get-Content $e) (Join-Path $SubPath 'WebDev.WebServer.EXE')
		if (Test-Path $wdpath) {
			return $wdpath
		}
	}
	return $FALSE
}
function Start-WebDevServer($Path, $Port=8080, $VPath='/')
{
	if (-not $Path -or -not (Test-Path $Path)) {
		Throw "Invalid Path specified!"
	}

	$locations =
		('CommonProgramFiles(x86)', 'Microsoft SharedDevServer9.0'),
		('CommonProgramFiles', 'Microsoft SharedDevServer9.0'),
		('SystemRoot', 'Microsoft.NETFrameworkv2.0.50727')

	foreach ($l in $locations) {
		$wdpath = TryLocateWebDevServer $l[0] $l[1]
		if ($wdpath) {
			break;
		}
	}
	if (-not $wdpath) {
		Throw 'Cannot locate WebDev.WebServer.EXE!'
	}
	
	$rpath = Resolve-Path $Path

	Write-Host "Starting WebDev.WebServer located at:"
	Write-Host " $wdpath"
	Write-Host " Parameters: ""/path:$rpath"" ""/port:$Port"" ""/vpath:$VPath"""

	& $wdpath "/path:$rpath" "/port:$Port" "/vpath:$VPath"
}
Set-Alias webdev Start-WebDevServer

Cheers!]]></wp:comment_content>
  <wp:comment_approved>1</wp:comment_approved>
  <wp:comment_type></wp:comment_type>
  <wp:comment_parent>0</wp:comment_parent>
  <wp:comment_user_id>0</wp:comment_user_id>
</wp:comment>