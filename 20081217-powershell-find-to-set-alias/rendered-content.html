<p>I use Live Mesh to keep my PowerShell scripts folder synced between
multiple machine. Some of those machines have different things installed
on them or have things installed in different locations. For example, my
laptop is x86 while my desktop is x64 so many things on the desktop get
installed into c:\Program Files (x86) instead of the plain-old
c:\Program Files folder. I wanted my shared profile script to be able
to search a set of folders for a given executable to alias, and I came
up with the following function.</p>
<div class="lang-powershell editor-colors"><div style="color:Black;background-color:White;"><pre>
<span style="color:Blue;">function</span> find<span style="color:Gray;">-</span>to<span style="color:Gray;">-</span>set<span style="color:Gray;">-</span>alias(<span style="color:OrangeRed;">$foldersearch</span>, <span style="color:OrangeRed;">$file</span>, <span style="color:OrangeRed;">$alias</span>)
{
  dir <span style="color:OrangeRed;">$foldersearch</span> |
    <span style="color:Gray;">%</span>{dir <span style="color:OrangeRed;">$_</span> <span style="color:Gray;">-</span>Recurse <span style="color:Gray;">-</span>Filter <span style="color:OrangeRed;">$file</span>} |
    <span style="color:Gray;">%</span>{set<span style="color:Gray;">-</span>alias <span style="color:OrangeRed;">$alias</span> <span style="color:OrangeRed;">$_</span>.FullName <span style="color:Gray;">-</span>scope Global; <span style="color:Blue;">break</span>}
}

</pre></div>
</div>
<p>It’s pretty simple to use. You pass in a folder search criteria – it
must have a wildcard, or the function won’t work – the file you’re
looking for and the alias you want to set. The function finds all the
folders matching the $foldersearch criteria, then searches them
recursively looking for the $file you specified. Set-alias is called
for the first matching $file found – pipeline processing is halted via
the break statement.</p>
<p>Here are the find-to-set-aliases I have in my profile:</p>
<div class="lang-powershell editor-colors"><div style="color:Black;background-color:White;"><pre>
find<span style="color:Gray;">-</span>to<span style="color:Gray;">-</span>set<span style="color:Gray;">-</span>alias <span style="color:#A31515;">&#39;c:\program files*\IronPython*&#39;</span> ipy.exe ipy
find<span style="color:Gray;">-</span>to<span style="color:Gray;">-</span>set<span style="color:Gray;">-</span>alias <span style="color:#A31515;">&#39;c:\program files*\IronPython*&#39;</span> chiron.exe chiron

find<span style="color:Gray;">-</span>to<span style="color:Gray;">-</span>set<span style="color:Gray;">-</span>alias <span style="color:#A31515;">&#39;c:\Python*&#39;</span> python.exe cpy

find<span style="color:Gray;">-</span>to<span style="color:Gray;">-</span>set<span style="color:Gray;">-</span>alias
    <span style="color:#A31515;">&#39;c:program files*\Microsoft Visual Studio 9.0\Common7&#39;</span> devenv.exe vs
find<span style="color:Gray;">-</span>to<span style="color:Gray;">-</span>set<span style="color:Gray;">-</span>alias
    <span style="color:#A31515;">&#39;c:program files*\Microsoft Visual Studio 9.0\Common7&#39;</span> tf.exe tf

find<span style="color:Gray;">-</span>to<span style="color:Gray;">-</span>set<span style="color:Gray;">-</span>alias <span style="color:#A31515;">&#39;c:\program files*\FSharp*&#39;</span> fsi.exe fsi
find<span style="color:Gray;">-</span>to<span style="color:Gray;">-</span>set<span style="color:Gray;">-</span>alias
    <span style="color:#A31515;">&#39;c:\program files*\Microsoft Repository SDK*&#39;</span> ipad.exe ipad
find<span style="color:Gray;">-</span>to<span style="color:Gray;">-</span>set<span style="color:Gray;">-</span>alias
    <span style="color:#A31515;">&#39;c:\program files*\Microsoft Virtual PC*&#39;</span> <span style="color:#A31515;">&#39;Virtual pc.exe&#39;</span> vpc

</pre></div>
</div>
<p>Python, IronPython and F# aliases, no surprise there. Chiron is the
REPL server for dynamic language Silverlight development. Typically, I
use <a href="http://www.tavaresstudios.com/Blog/post/The-last-vsvars32ps1-Ill-ever-need.aspx">Chris Tavares’ vsvars
script</a>
to configure the command shell for development purposes, but I find it’s
nice to have aliases for TF and DevEnv handy at all times.</p>
